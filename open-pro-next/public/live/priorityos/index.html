<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PriorityOS â€” AI Thinks Ahead So You Don't Have To</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=Plus+Jakarta+Sans:ital,wght@0,300;0,400;0,500;0,600;1,400&display=swap" rel="stylesheet">
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DESIGN SYSTEM â€” PRIORITY OS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root {
  --bg:        #0d1117;
  --bg2:       #111827;
  --surface:   #1c2333;
  --surface2:  #1f2937;
  --surface3:  #252f42;
  --border:    rgba(255,255,255,0.07);
  --border2:   rgba(255,255,255,0.12);
  --border3:   rgba(255,255,255,0.18);

  --blue:      #3b82f6;
  --blue-dim:  rgba(59,130,246,0.15);
  --green:     #10b981;
  --green-dim: rgba(16,185,129,0.15);
  --amber:     #f59e0b;
  --amber-dim: rgba(245,158,11,0.15);
  --red:       #ef4444;
  --red-dim:   rgba(239,68,68,0.15);
  --violet:    #8b5cf6;
  --violet-dim:rgba(139,92,246,0.15);
  --gold:      #f59e0b;

  --text:      #f9fafb;
  --text2:     #9ca3af;
  --text3:     #6b7280;

  --r:         12px;
  --r2:        8px;
  --r3:        16px;
}

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

html { font-size: 14px; scroll-behavior: smooth; }

body {
  font-family: 'Plus Jakarta Sans', sans-serif;
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  overflow: hidden;
}

/* â”€â”€ SCROLLBARS â”€â”€ */
::-webkit-scrollbar { width: 4px; height: 4px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--surface3); border-radius: 2px; }
::-webkit-scrollbar-thumb:hover { background: var(--border3); }

/* â”€â”€ ANIMATED BACKGROUND â”€â”€ */
.bg-glow {
  position: fixed; inset: 0; z-index: 0; pointer-events: none; overflow: hidden;
}
.glow-orb {
  position: absolute; border-radius: 50%; filter: blur(100px); opacity: 0.08;
  animation: orbDrift 20s ease-in-out infinite;
}
.glow-orb:nth-child(1) { width:800px;height:800px;top:-300px;left:-200px;background:#3b82f6;animation-delay:0s; }
.glow-orb:nth-child(2) { width:600px;height:600px;bottom:-200px;right:-150px;background:#8b5cf6;animation-delay:-7s; }
.glow-orb:nth-child(3) { width:400px;height:400px;top:40%;left:35%;background:#10b981;opacity:0.04;animation-delay:-14s; }

@keyframes orbDrift {
  0%,100% { transform: translate(0,0) scale(1); }
  33%  { transform: translate(40px,-50px) scale(1.06); }
  66%  { transform: translate(-30px,30px) scale(0.95); }
}

/* â”€â”€ LAYOUT â”€â”€ */
.app {
  position: relative; z-index: 1;
  display: grid;
  grid-template-columns: 220px 1fr;
  grid-template-rows: 100vh;
  overflow: hidden;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SIDEBAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.sidebar {
  background: rgba(17,24,39,0.95);
  backdrop-filter: blur(20px);
  border-right: 1px solid var(--border);
  display: flex; flex-direction: column;
  height: 100vh; overflow-y: auto;
}

.sidebar-brand {
  padding: 22px 18px 18px;
  border-bottom: 1px solid var(--border);
}
.brand-row {
  display: flex; align-items: center; gap: 10px;
}
.brand-icon {
  width: 34px; height: 34px; border-radius: 9px;
  background: linear-gradient(135deg, #3b82f6, #8b5cf6);
  display: flex; align-items: center; justify-content: center;
  font-size: 16px; flex-shrink: 0;
}
.brand-name {
  font-family: 'Syne', sans-serif;
  font-size: 17px; font-weight: 800; letter-spacing: -0.3px;
}
.brand-tagline {
  font-size: 10px; color: var(--text3); margin-top: 5px;
  letter-spacing: 0.3px;
}

/* User card */
.sidebar-user {
  margin: 14px 14px 0;
  padding: 12px 14px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--r);
  display: flex; align-items: center; gap: 10px;
}
.user-avatar {
  width: 32px; height: 32px; border-radius: 50%;
  background: linear-gradient(135deg, #3b82f6, #10b981);
  display: flex; align-items: center; justify-content: center;
  font-size: 13px; font-weight: 700; flex-shrink: 0;
}
.user-name { font-size: 13px; font-weight: 600; }
.user-role { font-size: 11px; color: var(--text3); }
.user-score {
  margin-left: auto;
  background: var(--green-dim);
  color: var(--green);
  font-size: 11px; font-weight: 700;
  padding: 3px 8px; border-radius: 20px;
}

/* Nav */
.sidebar-nav {
  padding: 18px 10px;
  flex: 1;
}
.nav-section-label {
  font-size: 10px; font-weight: 600; text-transform: uppercase;
  letter-spacing: 1.2px; color: var(--text3);
  padding: 0 8px; margin-bottom: 6px; margin-top: 14px;
}
.nav-section-label:first-child { margin-top: 0; }
.nav-item {
  display: flex; align-items: center; gap: 10px;
  padding: 9px 10px; border-radius: var(--r2);
  cursor: pointer; transition: all 0.18s;
  font-size: 13px; font-weight: 500; color: var(--text2);
  border: 1px solid transparent;
  margin-bottom: 2px; user-select: none;
}
.nav-item:hover { background: var(--surface2); color: var(--text); }
.nav-item.active {
  background: var(--blue-dim);
  border-color: rgba(59,130,246,0.25);
  color: var(--text);
}
.nav-item .ni { font-size: 16px; width: 20px; text-align: center; flex-shrink: 0; }
.nav-badge {
  margin-left: auto; font-size: 10px; font-weight: 700;
  padding: 2px 7px; border-radius: 20px;
}
.nb-blue  { background: var(--blue-dim); color: var(--blue); }
.nb-green { background: var(--green-dim); color: var(--green); }
.nb-amber { background: var(--amber-dim); color: var(--amber); }
.nb-red   { background: var(--red-dim); color: var(--red); }
.nb-violet{ background: var(--violet-dim); color: var(--violet); }

/* Streak card */
.streak-card {
  margin: 0 14px 14px;
  padding: 14px;
  background: linear-gradient(135deg, rgba(245,158,11,0.12), rgba(239,68,68,0.08));
  border: 1px solid rgba(245,158,11,0.2);
  border-radius: var(--r);
}
.streak-row { display: flex; align-items: center; gap: 8px; }
.streak-fire { font-size: 22px; }
.streak-num  { font-family: 'Syne', sans-serif; font-size: 22px; font-weight: 800; color: var(--amber); }
.streak-label{ font-size: 11px; color: var(--text3); margin-top: 2px; }
.streak-bar  { margin-top: 10px; background: rgba(255,255,255,0.08); height: 4px; border-radius: 2px; overflow: hidden; }
.streak-fill { height: 100%; background: linear-gradient(90deg, var(--amber), var(--red)); border-radius: 2px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MAIN CONTENT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.main {
  display: flex; flex-direction: column;
  height: 100vh; overflow: hidden;
}

/* â”€â”€ TOP BAR â”€â”€ */
.topbar {
  background: rgba(13,17,23,0.9);
  backdrop-filter: blur(16px);
  border-bottom: 1px solid var(--border);
  padding: 0 24px;
  height: 56px;
  display: flex; align-items: center; gap: 12px;
  flex-shrink: 0; z-index: 20;
}
.topbar-title {
  font-family: 'Syne', sans-serif;
  font-size: 16px; font-weight: 700; flex-shrink: 0;
}
.topbar-sub { font-size: 12px; color: var(--text3); }
.topbar-divider { width: 1px; height: 20px; background: var(--border); }
.topbar-spacer { flex: 1; }

/* Quick stat chips */
.qs-chip {
  display: flex; align-items: center; gap: 6px;
  padding: 5px 12px; border-radius: 20px;
  font-size: 12px; font-weight: 600; white-space: nowrap;
}
.qs-blue  { background: var(--blue-dim); color: var(--blue); }
.qs-green { background: var(--green-dim); color: var(--green); }
.qs-amber { background: var(--amber-dim); color: var(--amber); }
.qs-violet{ background: var(--violet-dim); color: var(--violet); }

/* Btn styles */
.btn {
  display: inline-flex; align-items: center; gap: 6px;
  padding: 7px 14px; border-radius: var(--r2); border: none;
  font-family: 'Plus Jakarta Sans', sans-serif;
  font-size: 12px; font-weight: 600; cursor: pointer;
  transition: all 0.18s; white-space: nowrap; text-decoration: none;
}
.btn-ghost {
  background: var(--surface); color: var(--text2);
  border: 1px solid var(--border2);
}
.btn-ghost:hover { background: var(--surface2); color: var(--text); border-color: var(--border3); }
.btn-primary {
  background: var(--blue); color: white;
}
.btn-primary:hover { background: #2563eb; transform: translateY(-1px); box-shadow: 0 4px 12px rgba(59,130,246,0.35); }
.btn-violet {
  background: var(--violet); color: white;
}
.btn-violet:hover { background: #7c3aed; transform: translateY(-1px); box-shadow: 0 4px 12px rgba(139,92,246,0.35); }
.btn-green {
  background: var(--green); color: white;
}
.btn-green:hover { background: #059669; }
.btn-sm { padding: 5px 10px; font-size: 11px; }
.btn-xs { padding: 3px 8px; font-size: 10px; }

/* â”€â”€ PAGE AREA â”€â”€ */
.pages {
  flex: 1; overflow-y: auto; overflow-x: hidden;
  position: relative;
}
.page {
  display: none; padding: 24px;
  animation: pageIn 0.25s ease;
}
.page.active { display: block; }
@keyframes pageIn {
  from { opacity: 0; transform: translateY(8px); }
  to   { opacity: 1; transform: translateY(0); }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CARDS & SHARED COMPONENTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--r3);
  padding: 20px;
}
.card-sm { padding: 14px 16px; }
.card-hover { transition: all 0.2s; cursor: pointer; }
.card-hover:hover { border-color: var(--border2); transform: translateY(-2px); box-shadow: 0 8px 32px rgba(0,0,0,0.4); }

.section-header {
  display: flex; align-items: center; justify-content: space-between;
  margin-bottom: 16px;
}
.section-title {
  font-family: 'Syne', sans-serif;
  font-size: 15px; font-weight: 700;
}
.section-sub { font-size: 12px; color: var(--text3); margin-top: 2px; }

/* Progress ring */
.ring-wrap { position: relative; display: inline-flex; align-items: center; justify-content: center; }
.ring-svg { transform: rotate(-90deg); }
.ring-track { fill: none; stroke: rgba(255,255,255,0.06); }
.ring-fill  { fill: none; stroke-linecap: round; transition: stroke-dashoffset 1.2s cubic-bezier(.4,0,.2,1); }
.ring-label {
  position: absolute; text-align: center;
  font-family: 'Syne', sans-serif; font-weight: 700;
}

/* Status badges */
.badge {
  display: inline-flex; align-items: center; gap: 4px;
  padding: 3px 8px; border-radius: 6px;
  font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px;
}
.b-track  { background: var(--green-dim); color: var(--green); }
.b-risk   { background: var(--amber-dim); color: var(--amber); }
.b-behind { background: var(--red-dim); color: var(--red); }
.b-done   { background: rgba(99,102,241,0.15); color: #818cf8; }
.b-p1     { background: var(--red-dim); color: var(--red); }
.b-p2     { background: var(--amber-dim); color: var(--amber); }
.b-p3     { background: var(--blue-dim); color: var(--blue); }
.b-ai     { background: var(--violet-dim); color: var(--violet); animation: aiPulse 3s ease-in-out infinite; }
.b-critical { background: rgba(239,68,68,0.2); color: #fca5a5; }
.b-high   { background: var(--amber-dim); color: var(--amber); }
.b-medium { background: var(--blue-dim); color: var(--blue); }
.b-low    { background: rgba(255,255,255,0.06); color: var(--text3); }

@keyframes aiPulse {
  0%,100% { box-shadow: 0 0 0 0 rgba(139,92,246,0.4); }
  50%     { box-shadow: 0 0 0 6px rgba(139,92,246,0); }
}

/* Priority score bar */
.score-bar {
  display: flex; gap: 2px; margin-top: 6px;
}
.score-seg {
  height: 3px; border-radius: 2px; flex: 1;
  background: rgba(255,255,255,0.07);
  transition: background 0.6s;
}
.seg-goal   { background: var(--violet); }
.seg-urg    { background: var(--red); }
.seg-energy { background: var(--amber); }
.seg-dep    { background: var(--blue); }

/* Tag chip */
.tag {
  display: inline-block; padding: 2px 8px;
  border-radius: 5px; font-size: 10px; font-weight: 600;
}
.tag-work   { background: var(--blue-dim); color: var(--blue); }
.tag-goal   { background: var(--violet-dim); color: var(--violet); }
.tag-health { background: var(--green-dim); color: var(--green); }
.tag-meet   { background: rgba(249,115,22,0.15); color: #fb923c; }
.tag-learn  { background: rgba(99,102,241,0.15); color: #818cf8; }

/* Divider */
.divider { height: 1px; background: var(--border); margin: 16px 0; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   VIEW 1: DASHBOARD
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.dashboard-grid {
  display: grid;
  grid-template-columns: 1fr 320px;
  gap: 20px;
}

/* Morning brief */
.morning-brief {
  background: linear-gradient(135deg, rgba(59,130,246,0.12) 0%, rgba(139,92,246,0.08) 100%);
  border: 1px solid rgba(59,130,246,0.25);
  border-radius: var(--r3);
  padding: 22px 24px;
  margin-bottom: 20px;
  position: relative; overflow: hidden;
}
.morning-brief::before {
  content: '';
  position: absolute; top: 0; left: 0; right: 0; height: 2px;
  background: linear-gradient(90deg, var(--blue), var(--violet));
}
.brief-eyebrow {
  display: flex; align-items: center; gap: 8px;
  font-size: 10px; font-weight: 700; text-transform: uppercase;
  letter-spacing: 1.5px; color: var(--blue); margin-bottom: 8px;
}
.brief-title {
  font-family: 'Syne', sans-serif;
  font-size: 20px; font-weight: 700; line-height: 1.3;
  margin-bottom: 10px;
}
.brief-ai-line {
  font-size: 13px; color: var(--text2); line-height: 1.6;
  padding: 10px 14px;
  background: rgba(0,0,0,0.2); border-radius: var(--r2);
  border-left: 3px solid var(--violet);
  margin-bottom: 16px;
}
.brief-stats {
  display: grid; grid-template-columns: repeat(4,1fr); gap: 12px;
}
.brief-stat {
  text-align: center;
  background: rgba(0,0,0,0.2); border-radius: var(--r2);
  padding: 10px 8px;
}
.brief-stat-val {
  font-family: 'Syne', sans-serif;
  font-size: 22px; font-weight: 800;
}
.brief-stat-label { font-size: 10px; color: var(--text3); margin-top: 2px; }

/* Today's tasks list */
.task-list { display: flex; flex-direction: column; gap: 8px; }
.task-row {
  display: flex; align-items: center; gap: 12px;
  padding: 12px 14px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--r);
  transition: all 0.18s; cursor: pointer;
  border-left: 3px solid var(--border);
}
.task-row:hover { border-color: var(--border2); background: var(--surface2); }
.task-row.completed {
  opacity: 0.5;
  background: rgba(16,185,129,0.05);
  border-left-color: var(--green) !important;
}
.task-check {
  width: 18px; height: 18px; border-radius: 5px;
  border: 2px solid var(--border3);
  display: flex; align-items: center; justify-content: center;
  flex-shrink: 0; transition: all 0.2s; cursor: pointer;
  font-size: 10px;
}
.task-check.done { background: var(--green); border-color: var(--green); color: white; }
.task-name { font-size: 13px; font-weight: 500; flex: 1; }
.task-name.done { text-decoration: line-through; color: var(--text3); }
.task-meta { display: flex; align-items: center; gap: 8px; flex-shrink: 0; }
.task-dur { font-size: 11px; color: var(--text3); }
.task-score-badge {
  font-size: 10px; font-weight: 700;
  padding: 2px 7px; border-radius: 5px;
}

/* Calendar mini timeline */
.cal-timeline { display: flex; flex-direction: column; gap: 6px; }
.cal-slot {
  display: flex; align-items: flex-start; gap: 10px;
  padding: 8px 10px; border-radius: var(--r2);
  border: 1px solid var(--border);
  background: var(--surface); cursor: pointer;
  transition: all 0.15s; position: relative;
}
.cal-slot::before {
  content: '';
  position: absolute; left: 0; top: 0; bottom: 0; width: 3px;
  border-radius: 3px 0 0 3px;
}
.cal-slot:hover { border-color: var(--border2); }
.cs-work::before  { background: var(--blue); }
.cs-goal::before  { background: var(--violet); }
.cs-health::before{ background: var(--green); }
.cs-meet::before  { background: #fb923c; }
.cs-ai::before    { background: var(--violet); }
.cs-ai { border-color: rgba(139,92,246,0.3); animation: aiSlotPulse 3s ease-in-out infinite; }
@keyframes aiSlotPulse {
  0%,100% { box-shadow: 0 0 0 0 rgba(139,92,246,0.15); }
  50%     { box-shadow: 0 0 0 4px rgba(139,92,246,0); }
}
.cal-time  { font-size: 11px; color: var(--text3); min-width: 56px; font-weight: 500; margin-top: 1px; }
.cal-event-name { font-size: 12px; font-weight: 600; margin-bottom: 2px; }
.cal-event-meta { font-size: 11px; color: var(--text3); }

/* Goal snapshots */
.goals-scroll {
  display: grid; grid-template-columns: repeat(auto-fill, minmax(200px,1fr));
  gap: 12px; margin-top: 12px;
}
.goal-snap {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--r);
  padding: 16px; cursor: pointer;
  transition: all 0.2s;
}
.goal-snap:hover { border-color: var(--border2); transform: translateY(-2px); box-shadow: 0 8px 24px rgba(0,0,0,0.4); }
.gs-head { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 12px; }
.gs-name { font-size: 13px; font-weight: 600; line-height: 1.3; }
.gs-deadline { font-size: 10px; color: var(--text3); margin-top: 3px; }
.gs-ring-wrap { display: flex; justify-content: center; margin: 10px 0; }
.gs-footer { display: flex; align-items: center; justify-content: space-between; margin-top: 8px; }
.gs-ai { font-size: 10px; color: var(--text3); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   VIEW 2: CALENDAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.cal-view-header {
  display: flex; align-items: center; gap: 12px; margin-bottom: 20px;
}
.cal-nav { display: flex; align-items: center; gap: 4px; }
.cal-nav-btn {
  width: 30px; height: 30px; border-radius: var(--r2);
  background: var(--surface); border: 1px solid var(--border2);
  color: var(--text2); font-size: 14px;
  display: flex; align-items: center; justify-content: center;
  cursor: pointer; transition: all 0.15s;
}
.cal-nav-btn:hover { background: var(--surface2); color: var(--text); }
.cal-period {
  font-family: 'Syne', sans-serif;
  font-size: 16px; font-weight: 700;
  padding: 0 8px;
}
.view-toggle { display: flex; background: var(--surface); border: 1px solid var(--border); border-radius: var(--r2); padding: 3px; gap: 2px; }
.vt-btn {
  padding: 5px 12px; border-radius: 6px; cursor: pointer;
  font-size: 12px; font-weight: 600; color: var(--text3);
  transition: all 0.15s; border: none; background: none;
}
.vt-btn.active { background: var(--surface2); color: var(--text); }

/* Week grid */
.week-grid {
  display: grid;
  grid-template-columns: 52px repeat(7, 1fr);
  border: 1px solid var(--border);
  border-radius: var(--r3);
  overflow: hidden;
  background: var(--surface);
}
.wg-header {
  background: var(--surface2);
  border-bottom: 1px solid var(--border);
}
.wg-day-head {
  padding: 10px 6px;
  text-align: center; border-left: 1px solid var(--border);
}
.wg-day-name { font-size: 10px; color: var(--text3); text-transform: uppercase; letter-spacing: 1px; }
.wg-day-num  { font-family: 'Syne', sans-serif; font-size: 18px; font-weight: 700; margin-top: 2px; }
.wg-day-num.today {
  background: var(--blue); color: white;
  width: 30px; height: 30px; border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  margin: 2px auto 0;
}

.wg-time-col { background: var(--surface2); }
.wg-time-label {
  height: 60px; display: flex; align-items: flex-start;
  justify-content: flex-end; padding: 6px 8px 0 0;
  font-size: 10px; color: var(--text3);
  border-bottom: 1px solid var(--border);
}
.wg-time-corner { height: 42px; }

.wg-day-col {
  border-left: 1px solid var(--border);
  position: relative; min-height: 480px;
}
.wg-hour-slot {
  height: 60px;
  border-bottom: 1px solid rgba(255,255,255,0.03);
  position: relative;
}

.cal-event-block {
  position: absolute; left: 3px; right: 3px;
  border-radius: 6px; padding: 5px 7px;
  cursor: pointer; z-index: 2;
  font-size: 11px; font-weight: 600;
  overflow: hidden; white-space: nowrap; text-overflow: ellipsis;
  transition: all 0.18s; border: 1px solid transparent;
}
.cal-event-block:hover { transform: scale(1.02); z-index: 10; overflow: visible; white-space: normal; }
.ev-work   { background: rgba(59,130,246,0.2); border-color: rgba(59,130,246,0.4); color: #93c5fd; }
.ev-goal   { background: rgba(139,92,246,0.2); border-color: rgba(139,92,246,0.4); color: #c4b5fd; }
.ev-health { background: rgba(16,185,129,0.2); border-color: rgba(16,185,129,0.4); color: #6ee7b7; }
.ev-meet   { background: rgba(249,115,22,0.2); border-color: rgba(249,115,22,0.4); color: #fdba74; }
.ev-ai     { background: rgba(139,92,246,0.12); border-color: var(--violet); color: #c4b5fd;
             animation: aiEventPulse 3s ease-in-out infinite; }
@keyframes aiEventPulse {
  0%,100% { box-shadow: 0 0 0 0 rgba(139,92,246,0.3); }
  50%     { box-shadow: 0 0 0 4px rgba(139,92,246,0); }
}
.ev-time { font-size: 9px; opacity: 0.7; margin-top: 1px; font-weight: 400; }

/* AI Optimize panel */
.ai-opt-panel {
  display: none; margin-top: 16px;
  background: var(--surface);
  border: 1px solid rgba(139,92,246,0.3);
  border-radius: var(--r3); padding: 20px;
  animation: pageIn 0.25s ease;
}
.ai-opt-panel.open { display: block; }
.aop-header { display: flex; align-items: center; gap: 10px; margin-bottom: 16px; }
.aop-title { font-family: 'Syne', sans-serif; font-size: 15px; font-weight: 700; }
.ai-eff-score {
  font-family: 'Syne', sans-serif;
  font-size: 40px; font-weight: 800; color: var(--amber); margin: 8px 0;
}
.aop-suggestions { display: flex; flex-direction: column; gap: 8px; margin-top: 12px; }
.aop-sug {
  display: flex; align-items: flex-start; gap: 10px;
  padding: 10px 12px; border-radius: var(--r2);
  background: var(--surface2); border: 1px solid var(--border);
}
.aop-sug-icon { font-size: 16px; flex-shrink: 0; margin-top: 1px; }
.aop-sug-text { font-size: 12px; color: var(--text2); line-height: 1.5; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   VIEW 3: GOALS HUB
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.goals-filter {
  display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 20px;
}
.gf-pill {
  padding: 6px 14px; border-radius: 20px;
  font-size: 12px; font-weight: 600; cursor: pointer;
  border: 1px solid var(--border2); color: var(--text3);
  background: transparent; transition: all 0.18s;
}
.gf-pill:hover { color: var(--text); border-color: var(--border3); }
.gf-pill.active { background: var(--blue-dim); border-color: rgba(59,130,246,0.4); color: var(--blue); }

.goals-grid {
  display: grid; grid-template-columns: repeat(auto-fill, minmax(320px,1fr));
  gap: 16px;
}
.goal-card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--r3); padding: 20px;
  cursor: pointer; transition: all 0.2s;
}
.goal-card:hover { border-color: var(--border2); transform: translateY(-3px); box-shadow: 0 12px 40px rgba(0,0,0,0.4); }
.gc-header { display: flex; align-items: flex-start; justify-content: space-between; margin-bottom: 14px; }
.gc-title  { font-family: 'Syne', sans-serif; font-size: 16px; font-weight: 700; line-height: 1.2; }
.gc-cat    { font-size: 11px; color: var(--text3); margin-top: 4px; }
.gc-badges { display: flex; gap: 5px; flex-wrap: wrap; }
.gc-progress-row { display: flex; align-items: center; gap: 16px; margin: 14px 0; }
.gc-ring-area { flex-shrink: 0; }
.gc-metrics { flex: 1; }
.gc-metric-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px; }
.gc-metric-label { font-size: 11px; color: var(--text3); }
.gc-metric-val   { font-size: 12px; font-weight: 600; }
.gc-bar { background: rgba(255,255,255,0.06); height: 4px; border-radius: 2px; overflow: hidden; margin-top: 3px; }
.gc-bar-fill { height: 100%; border-radius: 2px; transition: width 1s ease; }

.gc-ai-insight {
  background: var(--violet-dim);
  border: 1px solid rgba(139,92,246,0.25);
  border-radius: var(--r2); padding: 10px 12px;
  margin: 12px 0;
}
.gc-ai-label { font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.8px; color: var(--violet); margin-bottom: 4px; }
.gc-ai-text  { font-size: 12px; color: var(--text2); line-height: 1.5; }

.gc-footer { display: flex; gap: 6px; margin-top: 14px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   VIEW 4: AI PRIORITY ENGINE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.priority-header-card {
  background: linear-gradient(135deg, rgba(139,92,246,0.12), rgba(59,130,246,0.08));
  border: 1px solid rgba(139,92,246,0.25);
  border-radius: var(--r3); padding: 20px 24px;
  margin-bottom: 20px; position: relative; overflow: hidden;
}
.priority-header-card::before {
  content: '';
  position: absolute; top: 0; left: 0; right: 0; height: 2px;
  background: linear-gradient(90deg, var(--violet), var(--blue));
}
.phc-top { display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px; }
.phc-title { font-family: 'Syne', sans-serif; font-size: 20px; font-weight: 800; }
.confidence-badge {
  display: flex; align-items: center; gap: 6px;
  background: var(--green-dim); color: var(--green);
  padding: 6px 14px; border-radius: 20px;
  font-size: 12px; font-weight: 700;
}
.conf-dot { width: 6px; height: 6px; border-radius: 50%; background: var(--green); }

.legend-grid { display: grid; grid-template-columns: repeat(4,1fr); gap: 10px; }
.legend-item {
  padding: 10px 12px; border-radius: var(--r2);
  background: rgba(0,0,0,0.2);
}
.li-icon { font-size: 18px; margin-bottom: 5px; }
.li-label { font-size: 11px; font-weight: 600; margin-bottom: 2px; }
.li-pct { font-size: 10px; color: var(--text3); }

/* Context filters */
.ctx-filters { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 20px; }
.ctx-btn {
  padding: 7px 14px; border-radius: 20px;
  font-size: 12px; font-weight: 600; cursor: pointer;
  border: 1px solid var(--border2); color: var(--text3);
  background: transparent; transition: all 0.18s;
}
.ctx-btn:hover { color: var(--text); }
.ctx-btn.active { background: var(--violet-dim); border-color: rgba(139,92,246,0.4); color: var(--violet); }

/* Priority items */
.priority-list { display: flex; flex-direction: column; gap: 10px; }

/* Top 3 spotlight */
.spotlight-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; margin-bottom: 14px; }
.spotlight-card {
  border-radius: var(--r3); padding: 18px;
  cursor: pointer; transition: all 0.2s;
  position: relative; overflow: hidden;
}
.spotlight-card:hover { transform: translateY(-2px); }
.spot-1 {
  background: linear-gradient(135deg, rgba(245,158,11,0.15), rgba(239,68,68,0.08));
  border: 1.5px solid rgba(245,158,11,0.3);
}
.spot-2 {
  background: linear-gradient(135deg, rgba(156,163,175,0.12), rgba(107,114,128,0.08));
  border: 1.5px solid rgba(156,163,175,0.25);
}
.spot-3 {
  background: linear-gradient(135deg, rgba(180,83,9,0.12), rgba(120,53,15,0.08));
  border: 1.5px solid rgba(180,83,9,0.25);
}
.spot-rank {
  font-family: 'Syne', sans-serif;
  font-size: 36px; font-weight: 800; opacity: 0.3; line-height: 1;
  margin-bottom: 8px;
}
.spot-name { font-size: 14px; font-weight: 700; margin-bottom: 6px; line-height: 1.3; }
.spot-score { font-family: 'Syne', sans-serif; font-size: 22px; font-weight: 800; }
.spot-score-label { font-size: 10px; color: var(--text3); }
.spot-reason { font-size: 11px; color: var(--text2); line-height: 1.5; margin: 8px 0; }
.start-timer-btn {
  display: inline-flex; align-items: center; gap: 5px;
  padding: 6px 12px; border-radius: var(--r2);
  background: rgba(255,255,255,0.1); border: 1px solid var(--border2);
  color: var(--text); font-size: 11px; font-weight: 600;
  cursor: pointer; transition: all 0.18s;
}
.start-timer-btn:hover { background: rgba(255,255,255,0.15); }

/* Regular priority row */
.pri-row {
  display: flex; align-items: flex-start; gap: 14px;
  padding: 14px 16px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--r); cursor: pointer;
  transition: all 0.18s;
}
.pri-row:hover { border-color: var(--border2); background: var(--surface2); }
.pri-rank {
  font-family: 'Syne', sans-serif;
  font-size: 20px; font-weight: 800; color: var(--text3);
  min-width: 28px; text-align: center; flex-shrink: 0;
  margin-top: 2px;
}
.pri-content { flex: 1; }
.pri-name { font-size: 13px; font-weight: 600; margin-bottom: 4px; }
.pri-reason { font-size: 11px; color: var(--violet); margin-bottom: 6px; line-height: 1.4; }
.pri-tags { display: flex; gap: 6px; flex-wrap: wrap; margin-bottom: 6px; }
.pri-score-area { display: flex; align-items: center; gap: 8px; }
.pri-score-num { font-size: 12px; font-weight: 700; }
.pri-actions { display: flex; gap: 6px; align-items: center; flex-shrink: 0; }

/* Pomodoro timer */
.pomo-overlay {
  display: none; position: fixed; inset: 0;
  background: rgba(0,0,0,0.7); backdrop-filter: blur(8px);
  z-index: 100; align-items: center; justify-content: center;
}
.pomo-overlay.open { display: flex; }
.pomo-modal {
  background: var(--surface);
  border: 1px solid var(--border2);
  border-radius: 20px; padding: 36px 40px;
  text-align: center; min-width: 320px;
  animation: pageIn 0.2s ease;
}
.pomo-title { font-family: 'Syne', sans-serif; font-size: 15px; font-weight: 700; color: var(--text3); margin-bottom: 4px; }
.pomo-task  { font-size: 16px; font-weight: 600; margin-bottom: 24px; }
.pomo-time  {
  font-family: 'Syne', sans-serif;
  font-size: 64px; font-weight: 800; letter-spacing: -2px;
  color: var(--blue); margin-bottom: 24px; line-height: 1;
}
.pomo-controls { display: flex; gap: 10px; justify-content: center; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   VIEW 5: NOVA AI
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.nova-layout {
  display: grid; grid-template-columns: 1fr 300px; gap: 20px;
  height: calc(100vh - 100px);
}
.chat-area {
  display: flex; flex-direction: column;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--r3); overflow: hidden;
}
.chat-header {
  padding: 16px 20px;
  border-bottom: 1px solid var(--border);
  display: flex; align-items: center; gap: 12px;
}
.nova-avatar {
  width: 38px; height: 38px; border-radius: 50%;
  background: linear-gradient(135deg, var(--violet), var(--blue));
  display: flex; align-items: center; justify-content: center;
  font-size: 18px; flex-shrink: 0;
  animation: novaGlow 3s ease-in-out infinite;
}
@keyframes novaGlow {
  0%,100% { box-shadow: 0 0 0 0 rgba(139,92,246,0.4); }
  50%     { box-shadow: 0 0 0 8px rgba(139,92,246,0); }
}
.nova-status-dot {
  width: 8px; height: 8px; border-radius: 50%; background: var(--green);
  animation: pulse 2s ease-in-out infinite;
}
@keyframes pulse { 0%,100% { opacity:1; } 50% { opacity:0.4; } }

.chat-messages {
  flex: 1; overflow-y: auto; padding: 20px;
  display: flex; flex-direction: column; gap: 14px;
}
.msg { display: flex; gap: 10px; max-width: 85%; }
.msg-user { align-self: flex-end; flex-direction: row-reverse; }
.msg-nova  { align-self: flex-start; }
.msg-avatar {
  width: 28px; height: 28px; border-radius: 50%; flex-shrink: 0;
  display: flex; align-items: center; justify-content: center;
  font-size: 12px; font-weight: 700;
}
.msg-a-nova { background: linear-gradient(135deg, var(--violet), var(--blue)); }
.msg-a-user { background: linear-gradient(135deg, var(--blue), var(--green)); }
.msg-bubble {
  padding: 10px 14px; border-radius: 12px;
  font-size: 13px; line-height: 1.6;
}
.msg-nova .msg-bubble  { background: var(--surface2); border: 1px solid var(--border); border-top-left-radius: 3px; }
.msg-user .msg-bubble  { background: var(--blue-dim); border: 1px solid rgba(59,130,246,0.25); border-top-right-radius: 3px; }
.msg-time { font-size: 10px; color: var(--text3); margin-top: 4px; }

.typing-indicator {
  display: flex; align-items: center; gap: 5px;
  padding: 10px 14px; background: var(--surface2);
  border: 1px solid var(--border); border-radius: 12px;
  border-top-left-radius: 3px;
}
.typing-dot {
  width: 6px; height: 6px; border-radius: 50%; background: var(--text3);
  animation: typingBounce 1.4s ease-in-out infinite;
}
.typing-dot:nth-child(2) { animation-delay: 0.2s; }
.typing-dot:nth-child(3) { animation-delay: 0.4s; }
@keyframes typingBounce {
  0%,60%,100% { transform: translateY(0); opacity:0.4; }
  30%         { transform: translateY(-4px); opacity:1; }
}

.chat-input-area {
  padding: 14px 16px;
  border-top: 1px solid var(--border);
}
.chat-input-row {
  display: flex; gap: 8px; align-items: center;
  background: var(--surface2); border: 1px solid var(--border2);
  border-radius: 10px; padding: 4px 4px 4px 14px;
}
.chat-input {
  flex: 1; background: none; border: none; outline: none;
  color: var(--text); font-family: 'Plus Jakarta Sans', sans-serif;
  font-size: 13px; padding: 6px 0;
}
.chat-input::placeholder { color: var(--text3); }
.chat-send {
  width: 32px; height: 32px; border-radius: 8px;
  background: var(--violet); border: none; color: white;
  font-size: 14px; cursor: pointer; display: flex; align-items: center; justify-content: center;
  transition: all 0.18s; flex-shrink: 0;
}
.chat-send:hover { background: #7c3aed; }

.quick-chips {
  display: flex; gap: 6px; flex-wrap: wrap; margin-top: 10px;
}
.q-chip {
  padding: 5px 11px; border-radius: 20px;
  font-size: 11px; font-weight: 500; cursor: pointer;
  background: var(--surface2); border: 1px solid var(--border2);
  color: var(--text2); transition: all 0.15s; white-space: nowrap;
}
.q-chip:hover { background: var(--violet-dim); border-color: rgba(139,92,246,0.3); color: var(--text); }

/* Nova sidebar */
.nova-sidebar { display: flex; flex-direction: column; gap: 14px; }
.nova-insight-card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--r3); padding: 16px;
}
.nic-label {
  font-size: 10px; font-weight: 700; text-transform: uppercase;
  letter-spacing: 1px; color: var(--violet); margin-bottom: 10px;
}
.nic-item {
  display: flex; gap: 8px; padding: 8px 0;
  border-bottom: 1px solid var(--border); font-size: 12px; color: var(--text2);
}
.nic-item:last-child { border-bottom: none; }
.nic-icon { font-size: 14px; flex-shrink: 0; margin-top: 1px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   VIEW 6: ANALYTICS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.analytics-toprow {
  display: grid; grid-template-columns: repeat(4,1fr); gap: 14px;
  margin-bottom: 20px;
}
.analytics-metric {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--r3); padding: 18px 20px;
  transition: all 0.2s;
}
.analytics-metric:hover { border-color: var(--border2); transform: translateY(-2px); }
.am-val {
  font-family: 'Syne', sans-serif;
  font-size: 28px; font-weight: 800; margin-bottom: 4px;
}
.am-label { font-size: 12px; color: var(--text3); }
.am-change { font-size: 11px; margin-top: 6px; font-weight: 600; }
.ch-up { color: var(--green); }
.ch-dn { color: var(--red); }

.charts-grid {
  display: grid; grid-template-columns: 1fr 1fr;
  gap: 16px; margin-bottom: 16px;
}
.chart-card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--r3); padding: 20px;
}
.chart-title {
  font-family: 'Syne', sans-serif;
  font-size: 14px; font-weight: 700; margin-bottom: 16px;
}

/* Heatmap */
.heatmap-grid {
  display: grid;
  grid-template-columns: repeat(13, 1fr);
  gap: 3px;
}
.hm-cell {
  aspect-ratio: 1; border-radius: 3px; cursor: pointer;
  transition: all 0.15s;
}
.hm-cell:hover { transform: scale(1.3); }
.hm-0 { background: rgba(255,255,255,0.05); }
.hm-1 { background: rgba(16,185,129,0.2); }
.hm-2 { background: rgba(16,185,129,0.4); }
.hm-3 { background: rgba(16,185,129,0.65); }
.hm-4 { background: var(--green); }

/* Donut chart */
.donut-wrap { display: flex; align-items: center; gap: 20px; }
.donut-legend { display: flex; flex-direction: column; gap: 8px; }
.dl-item { display: flex; align-items: center; gap: 8px; font-size: 12px; }
.dl-dot { width: 10px; height: 10px; border-radius: 50%; flex-shrink: 0; }

/* Bar chart */
.bar-chart { display: flex; align-items: flex-end; gap: 8px; height: 120px; }
.bc-bar-wrap { flex: 1; display: flex; flex-direction: column; align-items: center; gap: 5px; }
.bc-bar {
  width: 100%; border-radius: 4px 4px 0 0;
  transition: height 1s ease; background: var(--blue);
  min-height: 4px;
}
.bc-label { font-size: 10px; color: var(--text3); text-align: center; }
.bc-val { font-size: 10px; font-weight: 600; }

/* AI Insight report */
.ai-report {
  background: linear-gradient(135deg, rgba(139,92,246,0.08), rgba(59,130,246,0.05));
  border: 1px solid rgba(139,92,246,0.2);
  border-radius: var(--r3); padding: 22px;
}
.air-header { display: flex; align-items: center; gap: 10px; margin-bottom: 16px; }
.air-title { font-family: 'Syne', sans-serif; font-size: 16px; font-weight: 700; }
.air-item {
  display: flex; gap: 10px; padding: 10px 0;
  border-bottom: 1px solid var(--border); font-size: 13px;
}
.air-item:last-child { border-bottom: none; }
.air-icon { font-size: 16px; flex-shrink: 0; margin-top: 1px; }
.air-text { color: var(--text2); line-height: 1.5; }
.air-highlight { color: var(--text); font-weight: 600; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   NOVA AI FLOATING BUTTON
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.nova-fab {
  position: fixed; bottom: 24px; right: 24px; z-index: 50;
}
.nova-fab-btn {
  width: 52px; height: 52px; border-radius: 50%;
  background: linear-gradient(135deg, var(--violet), var(--blue));
  border: none; cursor: pointer; color: white;
  font-size: 22px; display: flex; align-items: center; justify-content: center;
  box-shadow: 0 4px 20px rgba(139,92,246,0.4);
  animation: fabPulse 3s ease-in-out infinite;
  transition: all 0.2s;
}
.nova-fab-btn:hover { transform: scale(1.1); box-shadow: 0 6px 28px rgba(139,92,246,0.6); }
@keyframes fabPulse {
  0%,100% { box-shadow: 0 4px 20px rgba(139,92,246,0.4); }
  50%     { box-shadow: 0 4px 32px rgba(139,92,246,0.7); }
}
.nova-fab-label {
  position: absolute; bottom: 58px; right: 0;
  background: var(--surface); border: 1px solid var(--border2);
  padding: 5px 12px; border-radius: 8px; font-size: 12px; font-weight: 600;
  white-space: nowrap; pointer-events: none;
  opacity: 0; transform: translateY(4px); transition: all 0.2s;
}
.nova-fab:hover .nova-fab-label { opacity: 1; transform: translateY(0); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOAST NOTIFICATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#toast-container {
  position: fixed; top: 70px; right: 20px; z-index: 200;
  display: flex; flex-direction: column; gap: 8px;
  pointer-events: none;
}
.toast-item {
  background: var(--surface);
  border: 1px solid var(--border2);
  border-radius: var(--r); padding: 12px 16px;
  display: flex; align-items: flex-start; gap: 10px;
  box-shadow: 0 8px 32px rgba(0,0,0,0.5);
  animation: toastIn 0.3s ease;
  max-width: 320px; pointer-events: all;
  font-size: 13px;
}
@keyframes toastIn {
  from { opacity:0; transform: translateX(20px); }
  to   { opacity:1; transform: translateX(0); }
}
.toast-icon { font-size: 18px; flex-shrink: 0; }
.toast-body { flex: 1; }
.toast-title { font-weight: 600; margin-bottom: 2px; }
.toast-msg { font-size: 12px; color: var(--text2); line-height: 1.4; }

/* Achievement overlay */
.achievement-overlay {
  display: none; position: fixed; inset: 0;
  z-index: 150; pointer-events: none;
  align-items: flex-end; justify-content: center;
  padding-bottom: 30px;
}
.achievement-overlay.show {
  display: flex; pointer-events: all;
}
.achievement-card {
  background: linear-gradient(135deg, rgba(245,158,11,0.15), rgba(239,68,68,0.1));
  border: 1.5px solid rgba(245,158,11,0.4);
  border-radius: 16px; padding: 20px 28px;
  text-align: center; min-width: 280px;
  animation: achieveIn 0.5s cubic-bezier(.34,1.56,.64,1);
  box-shadow: 0 16px 48px rgba(0,0,0,0.6);
}
@keyframes achieveIn {
  from { opacity:0; transform: translateY(40px) scale(0.85); }
  to   { opacity:1; transform: translateY(0) scale(1); }
}
.ach-emoji { font-size: 48px; margin-bottom: 8px; }
.ach-label { font-size: 11px; text-transform: uppercase; letter-spacing: 2px; color: var(--amber); font-weight: 700; }
.ach-name  { font-family: 'Syne', sans-serif; font-size: 22px; font-weight: 800; margin: 4px 0; }
.ach-desc  { font-size: 13px; color: var(--text2); }

/* Confetti */
.confetti-piece {
  position: fixed; z-index: 300; pointer-events: none;
  width: 8px; height: 8px; border-radius: 2px;
  animation: confettiFall 2.5s ease-out forwards;
}
@keyframes confettiFall {
  0%   { transform: translateY(-20px) rotate(0deg); opacity: 1; }
  100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESPONSIVE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media (max-width: 1100px) {
  .app { grid-template-columns: 200px 1fr; }
  .spotlight-grid { grid-template-columns: 1fr 1fr; }
  .analytics-toprow { grid-template-columns: repeat(2,1fr); }
  .legend-grid { grid-template-columns: repeat(2,1fr); }
}
@media (max-width: 860px) {
  .app { grid-template-columns: 1fr; }
  .sidebar { display: none; }
  .dashboard-grid { grid-template-columns: 1fr; }
  .nova-layout { grid-template-columns: 1fr; }
  .charts-grid { grid-template-columns: 1fr; }
}
</style>
</head>
<body>

<!-- Background -->
<div class="bg-glow">
  <div class="glow-orb"></div>
  <div class="glow-orb"></div>
  <div class="glow-orb"></div>
</div>

<!-- Main App Shell -->
<div class="app">

  <!-- â•â•â•â•â•â•â•â•â•â•â•â• SIDEBAR â•â•â•â•â•â•â•â•â•â•â•â• -->
  <aside class="sidebar">
    <div class="sidebar-brand">
      <div class="brand-row">
        <div class="brand-icon">âš¡</div>
        <div class="brand-name">PriorityOS</div>
      </div>
      <div class="brand-tagline">Your AI thinks ahead so you don't have to</div>
    </div>

    <div class="sidebar-user">
      <div class="user-avatar">J</div>
      <div>
        <div class="user-name">Jordan</div>
        <div class="user-role">Founder Â· Pro Plan</div>
      </div>
      <div class="user-score">78â†‘</div>
    </div>

    <nav class="sidebar-nav">
      <div class="nav-section-label">Workspace</div>
      <div class="nav-item active" onclick="switchPage('dashboard', this)">
        <span class="ni">ğŸ </span> Dashboard
        <span class="nav-badge nb-blue">Live</span>
      </div>
      <div class="nav-item" onclick="switchPage('calendar', this)">
        <span class="ni">ğŸ“…</span> Calendar
      </div>
      <div class="nav-item" onclick="switchPage('goals', this)">
        <span class="ni">ğŸ¯</span> Goals
        <span class="nav-badge nb-amber">1 At Risk</span>
      </div>
      <div class="nav-item" onclick="switchPage('priority', this)">
        <span class="ni">âš¡</span> AI Priorities
        <span class="nav-badge nb-violet">87%</span>
      </div>

      <div class="nav-section-label">AI</div>
      <div class="nav-item" onclick="switchPage('nova', this)">
        <span class="ni">ğŸ¤–</span> Nova AI
        <span class="nav-badge nb-violet">Active</span>
      </div>
      <div class="nav-item" onclick="switchPage('analytics', this)">
        <span class="ni">ğŸ“Š</span> Analytics
      </div>

      <div class="nav-section-label">Account</div>
      <div class="nav-item" onclick="showToast('âš™ï¸','Settings','Settings panel coming soon!')">
        <span class="ni">âš™ï¸</span> Settings
      </div>
      <div class="nav-item" onclick="showToast('ğŸ’','Upgrade','Pro plan gives you unlimited AI queries and integrations!')">
        <span class="ni">ğŸ’</span> Upgrade Plan
      </div>
    </nav>

    <div class="streak-card">
      <div class="streak-row">
        <div class="streak-fire">ğŸ”¥</div>
        <div>
          <div class="streak-num">14</div>
          <div class="streak-label">Day streak â€” Keep it going!</div>
        </div>
      </div>
      <div class="streak-bar">
        <div class="streak-fill" style="width:47%"></div>
      </div>
      <div style="font-size:10px;color:var(--text3);margin-top:5px;">16 days until next badge ğŸ…</div>
    </div>
  </aside>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â• MAIN â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="main">

    <!-- Topbar -->
    <div class="topbar">
      <div>
        <div class="topbar-title" id="topbar-title">Good Morning, Jordan ğŸ‘‹</div>
        <div class="topbar-sub" id="topbar-sub">Tuesday, February 17 Â· 5 goals active Â· Focus Level: High</div>
      </div>
      <div class="topbar-divider"></div>
      <div class="qs-chip qs-blue">ğŸ“‹ 8 tasks today</div>
      <div class="qs-chip qs-green">âœ… 3 on track</div>
      <div class="qs-chip qs-amber">âš ï¸ 1 at risk</div>
      <div class="qs-chip qs-violet">ğŸ¤– 87% AI confidence</div>
      <div class="topbar-spacer"></div>
      <button class="btn btn-ghost" onclick="showToast('â•','New Task','Task creation modal â€” add your task details')">+ Add Task</button>
      <button class="btn btn-violet" onclick="switchPage('nova', document.querySelector(\'.nav-item:nth-child(5)\'))">Ask Nova ğŸ¤–</button>
    </div>

    <!-- Pages -->
    <div class="pages">

      <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PAGE: DASHBOARD â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <div id="page-dashboard" class="page active">

        <!-- Morning Brief -->
        <div class="morning-brief">
          <div class="brief-eyebrow">
            <span>ğŸ¤–</span> AI Morning Brief Â· Updated 2 min ago
          </div>
          <div class="brief-title" id="brief-greeting">Good morning, Jordan! You're on pace for a strong week.</div>
          <div class="brief-ai-line">
            <strong style="color:var(--violet)">Nova says:</strong> You have <strong>3 high-priority tasks</strong> that directly support your SaaS launch goal (deadline in 42 days). Start with <strong>"Finalize pricing page copy"</strong> â€” your peak focus window opens in 15 minutes and this task is blocking developer handoff due tomorrow. Confidence: <span style="color:var(--green)">97%</span>
          </div>
          <div class="brief-stats">
            <div class="brief-stat">
              <div class="brief-stat-val" style="color:var(--blue)">8</div>
              <div class="brief-stat-label">Tasks Due Today</div>
            </div>
            <div class="brief-stat">
              <div class="brief-stat-val" style="color:var(--green)">3</div>
              <div class="brief-stat-label">Goals On Track</div>
            </div>
            <div class="brief-stat">
              <div class="brief-stat-val" style="color:var(--amber)">1</div>
              <div class="brief-stat-label">At Risk</div>
            </div>
            <div class="brief-stat">
              <div class="brief-stat-val" style="color:var(--violet)">3.5h</div>
              <div class="brief-stat-label">Free Time</div>
            </div>
          </div>
        </div>

        <div class="dashboard-grid">
          <!-- Left: Today's Tasks -->
          <div>
            <div class="section-header">
              <div>
                <div class="section-title">Today's AI Priority List</div>
                <div class="section-sub">Ranked by impact, urgency & energy match</div>
              </div>
              <button class="btn btn-ghost btn-sm" onclick="switchPage('priority', document.querySelector('.nav-item:nth-child(4)'))">Full View â†’</button>
            </div>

            <div class="task-list" id="dashboard-tasks">
              <!-- populated by JS -->
            </div>
          </div>

          <!-- Right: Calendar Today -->
          <div>
            <div class="section-header">
              <div>
                <div class="section-title">Today's Schedule</div>
                <div class="section-sub">Tuesday, February 17</div>
              </div>
              <button class="btn btn-ghost btn-sm" onclick="switchPage('calendar', document.querySelector('.nav-item:nth-child(2)'))">Full Calendar â†’</button>
            </div>

            <div class="cal-timeline" id="dashboard-cal">
              <!-- populated by JS -->
            </div>
          </div>
        </div>

        <!-- Goal Snapshots -->
        <div style="margin-top:24px">
          <div class="section-header">
            <div>
              <div class="section-title">Goal Progress Snapshot</div>
              <div class="section-sub">5 active goals â€” 2 on track, 1 at risk, 1 behind</div>
            </div>
            <button class="btn btn-ghost btn-sm" onclick="switchPage('goals', document.querySelector('.nav-item:nth-child(3)'))">Goal Hub â†’</button>
          </div>
          <div class="goals-scroll" id="dashboard-goals"></div>
        </div>

      </div>

      <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PAGE: CALENDAR â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <div id="page-calendar" class="page">
        <div class="cal-view-header">
          <div class="cal-nav">
            <div class="cal-nav-btn" onclick="showToast('ğŸ“…','Calendar','Navigated to previous week')">â€¹</div>
            <div class="cal-period">Feb 17 â€“ 23, 2026</div>
            <div class="cal-nav-btn" onclick="showToast('ğŸ“…','Calendar','Navigated to next week')">â€º</div>
          </div>
          <button class="btn btn-ghost btn-sm" onclick="showToast('ğŸ“…','Today','Jumped to current date')">Today</button>
          <div class="view-toggle">
            <button class="vt-btn" onclick="setVT(this)">Day</button>
            <button class="vt-btn active" onclick="setVT(this)">Week</button>
            <button class="vt-btn" onclick="setVT(this)">Month</button>
            <button class="vt-btn" onclick="setVT(this)">Agenda</button>
          </div>
          <div style="flex:1"></div>
          <button class="btn btn-ghost btn-sm" onclick="showToast('â•','New Event','Event creation dialog opening...')">+ Event</button>
          <button class="btn btn-violet" onclick="toggleAIOptimize()">âœ¨ AI Optimize Week</button>
        </div>

        <!-- Week Grid -->
        <div class="week-grid" id="week-grid"></div>

        <!-- AI Optimize Panel -->
        <div class="ai-opt-panel" id="ai-opt-panel">
          <div class="aop-header">
            <span style="font-size:20px">âœ¨</span>
            <div class="aop-title">AI Schedule Optimization</div>
            <span class="badge b-ai" style="margin-left:auto">Analysis Complete</span>
          </div>
          <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:14px;margin-bottom:16px">
            <div style="background:var(--surface2);border:1px solid var(--border);border-radius:var(--r2);padding:14px;text-align:center">
              <div class="ai-eff-score">67%</div>
              <div style="font-size:11px;color:var(--text3)">Current Efficiency</div>
            </div>
            <div style="background:var(--surface2);border:1px solid var(--border);border-radius:var(--r2);padding:14px;text-align:center">
              <div style="font-family:'Syne',sans-serif;font-size:40px;font-weight:800;color:var(--green);margin:8px 0">89%</div>
              <div style="font-size:11px;color:var(--text3)">With AI Optimization</div>
            </div>
            <div style="background:var(--surface2);border:1px solid var(--border);border-radius:var(--r2);padding:14px;text-align:center">
              <div style="font-family:'Syne',sans-serif;font-size:40px;font-weight:800;color:var(--blue);margin:8px 0">4.2h</div>
              <div style="font-size:11px;color:var(--text3)">Time Recovered</div>
            </div>
          </div>
          <div class="aop-suggestions">
            <div class="aop-sug">
              <div class="aop-sug-icon">ğŸ”„</div>
              <div class="aop-sug-text"><strong>Move "AWS Module 7"</strong> from Friday 3pm to Thursday 8â€“9am â€” your retention scores are 40% higher in the morning. <span style="color:var(--green);font-weight:600">+Goal Impact</span></div>
            </div>
            <div class="aop-sug">
              <div class="aop-sug-icon">ğŸ›¡ï¸</div>
              <div class="aop-sug-text"><strong>Protect Thursday 8amâ€“12pm</strong> as a deep work block â€” you have no meetings and this is your highest-focus window of the week.</div>
            </div>
            <div class="aop-sug">
              <div class="aop-sug-icon">âš¡</div>
              <div class="aop-sug-text"><strong>Batch Tuesday admin tasks</strong> (3 emails + 2 reviews) into a 45-min block at 1pm â€” context switching is costing you ~90 min/week.</div>
            </div>
            <div class="aop-sug">
              <div class="aop-sug-icon">ğŸ¯</div>
              <div class="aop-sug-text"><strong>Add 90-min YouTube sprint</strong> on Wednesday 2pm â€” you're behind on your YouTube goal and this is your only unscheduled afternoon slot.</div>
            </div>
          </div>
          <div style="display:flex;gap:8px;margin-top:14px">
            <button class="btn btn-primary" onclick="applyAIOptimize()">âœ¨ Apply All Suggestions</button>
            <button class="btn btn-ghost" onclick="toggleAIOptimize()">Dismiss</button>
          </div>
        </div>
      </div>

      <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PAGE: GOALS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <div id="page-goals" class="page">
        <!-- Stats row -->
        <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin-bottom:20px" id="goals-stats-row"></div>

        <div class="goals-filter">
          <button class="gf-pill active" onclick="filterGoals('all',this)">All Goals (5)</button>
          <button class="gf-pill" onclick="filterGoals('business',this)">ğŸš€ Business</button>
          <button class="gf-pill" onclick="filterGoals('content',this)">ğŸ¬ Content</button>
          <button class="gf-pill" onclick="filterGoals('health',this)">ğŸ’ª Health</button>
          <button class="gf-pill" onclick="filterGoals('learning',this)">ğŸ“š Learning</button>
          <button class="gf-pill" onclick="filterGoals('writing',this)">âœï¸ Writing</button>
        </div>

        <div class="goals-grid" id="goals-grid"></div>
      </div>

      <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PAGE: AI PRIORITIES â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <div id="page-priority" class="page">
        <div class="priority-header-card">
          <div class="phc-top">
            <div>
              <div style="font-size:11px;color:var(--violet);text-transform:uppercase;letter-spacing:1.5px;font-weight:700;margin-bottom:6px">âš¡ AI Priority Engine</div>
              <div class="phc-title">Today's AI Priority List</div>
              <div style="font-size:13px;color:var(--text3);margin-top:4px">Ranked by impact Â· urgency Â· energy match Â· dependencies</div>
            </div>
            <div style="display:flex;flex-direction:column;align-items:flex-end;gap:8px">
              <div class="confidence-badge">
                <div class="conf-dot"></div>
                87% AI Confidence
              </div>
              <button class="btn btn-ghost btn-sm" onclick="refreshPriorities()">ğŸ”„ Refresh</button>
            </div>
          </div>
          <div class="legend-grid">
            <div class="legend-item">
              <div class="li-icon">ğŸ¯</div>
              <div class="li-label">Goal Impact</div>
              <div class="li-pct">30% weight</div>
            </div>
            <div class="legend-item">
              <div class="li-icon">â°</div>
              <div class="li-label">Urgency</div>
              <div class="li-pct">25% weight</div>
            </div>
            <div class="legend-item">
              <div class="li-icon">âš¡</div>
              <div class="li-label">Energy Match</div>
              <div class="li-pct">25% weight</div>
            </div>
            <div class="legend-item">
              <div class="li-icon">ğŸ”—</div>
              <div class="li-label">Dependencies</div>
              <div class="li-pct">20% weight</div>
            </div>
          </div>
        </div>

        <!-- Context filters -->
        <div class="ctx-filters">
          <button class="ctx-btn active" onclick="setCtx(this)">ğŸ• Right Now</button>
          <button class="ctx-btn" onclick="setCtx(this)">ğŸŒ… This Morning</button>
          <button class="ctx-btn" onclick="setCtx(this)">ğŸ§  Deep Work</button>
          <button class="ctx-btn" onclick="setCtx(this)">âš¡ Quick Wins</button>
          <button class="ctx-btn" onclick="setCtx(this)">ğŸ¯ Goal-Critical</button>
        </div>

        <!-- Top 3 Spotlight -->
        <div class="section-header">
          <div class="section-title">ğŸ† Top Priority Spotlight</div>
        </div>
        <div class="spotlight-grid" id="spotlight-grid"></div>

        <!-- Full list 4-10 -->
        <div class="section-header" style="margin-top:20px">
          <div class="section-title">Remaining Priorities</div>
          <div class="section-sub">Items #4â€“10</div>
        </div>
        <div class="priority-list" id="priority-list"></div>
      </div>

      <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PAGE: NOVA AI â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <div id="page-nova" class="page" style="padding-bottom:0">
        <div class="nova-layout" style="height:calc(100vh - 56px - 48px)">

          <!-- Chat -->
          <div class="chat-area">
            <div class="chat-header">
              <div class="nova-avatar">ğŸ¤–</div>
              <div>
                <div style="font-size:14px;font-weight:700">Nova AI</div>
                <div style="font-size:11px;color:var(--text3);display:flex;align-items:center;gap:5px">
                  <div class="nova-status-dot"></div> Online Â· AI-powered by Claude
                </div>
              </div>
              <div style="margin-left:auto;display:flex;gap:6px">
                <span class="badge b-violet">GPT-4</span>
                <button class="btn btn-ghost btn-xs" onclick="clearChat()">Clear Chat</button>
              </div>
            </div>

            <div class="chat-messages" id="chat-messages">
              <!-- Messages injected by JS -->
            </div>

            <div class="chat-input-area">
              <div class="chat-input-row">
                <input class="chat-input" id="chat-input" placeholder="Ask Nova anything about your schedule, goals, or priorities..." 
                       onkeydown="if(event.key==='Enter') sendChat()">
                <button class="chat-send" onclick="sendChat()">â†‘</button>
              </div>
              <div class="quick-chips">
                <div class="q-chip" onclick="quickAsk('Prioritize my day')">Prioritize my day</div>
                <div class="q-chip" onclick="quickAsk('What\'s my biggest risk this week?')">Biggest risk?</div>
                <div class="q-chip" onclick="quickAsk('I have 90 minutes free right now')">90 min free</div>
                <div class="q-chip" onclick="quickAsk('Am I going to hit my SaaS launch goal?')">SaaS goal check</div>
                <div class="q-chip" onclick="quickAsk('I\'m feeling low energy right now')">Low energy</div>
                <div class="q-chip" onclick="quickAsk('Plan my week around my top goal')">Plan my week</div>
              </div>
            </div>
          </div>

          <!-- Nova sidebar -->
          <div class="nova-sidebar" style="overflow-y:auto">
            <div class="nova-insight-card">
              <div class="nic-label">âš¡ Real-time Insights</div>
              <div class="nic-item"><div class="nic-icon">ğŸ¯</div><div>Your #1 priority has been waiting 3 days â€” Nova flagged it as critical</div></div>
              <div class="nic-item"><div class="nic-icon">â°</div><div>Peak focus window opens in 12 minutes (9â€“11 AM)</div></div>
              <div class="nic-item"><div class="nic-icon">âš ï¸</div><div>YouTube goal is behind â€” 4 days since last upload</div></div>
              <div class="nic-item"><div class="nic-icon">âœ…</div><div>Half-marathon training is on track â€” race in 56 days</div></div>
            </div>

            <div class="nova-insight-card">
              <div class="nic-label">ğŸ“Š Today's Stats</div>
              <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:4px">
                <div style="background:var(--surface2);border-radius:var(--r2);padding:10px;text-align:center">
                  <div style="font-family:'Syne',sans-serif;font-size:20px;font-weight:800;color:var(--blue)">3/8</div>
                  <div style="font-size:10px;color:var(--text3)">Tasks Done</div>
                </div>
                <div style="background:var(--surface2);border-radius:var(--r2);padding:10px;text-align:center">
                  <div style="font-family:'Syne',sans-serif;font-size:20px;font-weight:800;color:var(--violet)">78</div>
                  <div style="font-size:10px;color:var(--text3)">Focus Score</div>
                </div>
                <div style="background:var(--surface2);border-radius:var(--r2);padding:10px;text-align:center">
                  <div style="font-family:'Syne',sans-serif;font-size:20px;font-weight:800;color:var(--green)">14ğŸ”¥</div>
                  <div style="font-size:10px;color:var(--text3)">Day Streak</div>
                </div>
                <div style="background:var(--surface2);border-radius:var(--r2);padding:10px;text-align:center">
                  <div style="font-family:'Syne',sans-serif;font-size:20px;font-weight:800;color:var(--amber)">3.5h</div>
                  <div style="font-size:10px;color:var(--text3)">Free Time</div>
                </div>
              </div>
            </div>

            <div class="nova-insight-card">
              <div class="nic-label">ğŸ§  Nova's Learning</div>
              <div class="nic-item"><div class="nic-icon">ğŸ“ˆ</div><div>You're 3x more productive on tasks scheduled before 10am</div></div>
              <div class="nic-item"><div class="nic-icon">ğŸ”„</div><div>You tend to reschedule admin tasks â€” AI now batches them automatically</div></div>
              <div class="nic-item"><div class="nic-icon">ğŸ’¡</div><div>Your most consistent goal activity is on Tues & Thurs mornings</div></div>
            </div>
          </div>
        </div>
      </div>

      <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PAGE: ANALYTICS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <div id="page-analytics" class="page">
        <div style="margin-bottom:20px">
          <div class="section-title" style="font-size:20px">ğŸ“Š Progress & Analytics</div>
          <div class="section-sub">Last 30 days Â· Jordan's productivity overview</div>
        </div>

        <div class="analytics-toprow">
          <div class="analytics-metric">
            <div class="am-val" style="color:var(--blue)">78</div>
            <div class="am-label">Weekly Productivity Score</div>
            <div class="am-change ch-up">â†‘ +12 from last week</div>
          </div>
          <div class="analytics-metric">
            <div class="am-val" style="color:var(--green)">2.4Ã—</div>
            <div class="am-label">Goal Velocity</div>
            <div class="am-change ch-up">â†‘ +0.4 vs target</div>
          </div>
          <div class="analytics-metric">
            <div class="am-val" style="color:var(--violet)">22h</div>
            <div class="am-label">Deep Focus Hours</div>
            <div class="am-change ch-up">â†‘ +6h vs last week</div>
          </div>
          <div class="analytics-metric">
            <div class="am-val" style="color:var(--amber)">89</div>
            <div class="am-label">Tasks Completed (month)</div>
            <div class="am-change ch-dn">â†“ -3 vs last month</div>
          </div>
        </div>

        <div class="charts-grid">
          <!-- Heatmap -->
          <div class="chart-card">
            <div class="chart-title">ğŸ“… 90-Day Focus Heatmap</div>
            <div class="heatmap-grid" id="heatmap-grid"></div>
            <div style="display:flex;gap:8px;margin-top:10px;align-items:center;font-size:11px;color:var(--text3)">
              <span>Less</span>
              <div style="width:10px;height:10px;border-radius:2px;background:rgba(255,255,255,0.05)"></div>
              <div style="width:10px;height:10px;border-radius:2px;background:rgba(16,185,129,0.2)"></div>
              <div style="width:10px;height:10px;border-radius:2px;background:rgba(16,185,129,0.5)"></div>
              <div style="width:10px;height:10px;border-radius:2px;background:var(--green)"></div>
              <span>More</span>
            </div>
          </div>

          <!-- Donut -->
          <div class="chart-card">
            <div class="chart-title">â± Time Allocation This Week</div>
            <div class="donut-wrap">
              <svg width="120" height="120" viewBox="0 0 120 120" id="donut-svg">
                <circle cx="60" cy="60" r="45" fill="none" stroke="rgba(255,255,255,0.05)" stroke-width="18"/>
                <!-- segments filled by JS -->
              </svg>
              <div class="donut-legend" id="donut-legend"></div>
            </div>
          </div>

          <!-- Bar chart -->
          <div class="chart-card">
            <div class="chart-title">ğŸ“ˆ Priority Execution Rate</div>
            <div class="bar-chart" id="bar-chart"></div>
          </div>

          <!-- Goal Progress -->
          <div class="chart-card">
            <div class="chart-title">ğŸ¯ Goal Health Overview</div>
            <div id="goal-health-bars"></div>
          </div>
        </div>

        <!-- AI Report -->
        <div class="ai-report">
          <div class="air-header">
            <span style="font-size:22px">ğŸ¤–</span>
            <div>
              <div class="air-title">Nova's Weekly AI Insight Report</div>
              <div style="font-size:12px;color:var(--text3)">Generated Tuesday, Feb 17 Â· Based on 8 weeks of data</div>
            </div>
            <span class="badge b-ai" style="margin-left:auto">AI Generated</span>
          </div>
          <div class="air-item">
            <div class="air-icon">âœ…</div>
            <div class="air-text"><span class="air-highlight">What worked:</span> You completed all 5 deep work blocks this week â€” your best streak in 4 weeks. Morning scheduling of hard tasks is clearly paying off.</div>
          </div>
          <div class="air-item">
            <div class="air-icon">ğŸ”</div>
            <div class="air-text"><span class="air-highlight">Pattern detected:</span> You consistently underestimate task duration by <strong>40%</strong>. Your 90-minute estimates typically take 2.5 hours. AI has adjusted your schedule buffer accordingly.</div>
          </div>
          <div class="air-item">
            <div class="air-icon">ğŸ’¡</div>
            <div class="air-text"><span class="air-highlight">Behavioral insight:</span> You're <strong>3Ã— more likely</strong> to complete tasks scheduled before 10 AM. Moving your two hardest tasks to morning slots next week could increase completion rate by ~35%.</div>
          </div>
          <div class="air-item">
            <div class="air-icon">ğŸ¯</div>
            <div class="air-text"><span class="air-highlight">Top recommendation:</span> Your YouTube goal is at risk. You need 3 uploads in the next 2 weeks to return to target pace. Nova has pre-blocked Tuesday and Thursday 9â€“11 AM for content creation â€” accept the blocks?</div>
          </div>
          <div style="margin-top:14px;display:flex;gap:8px">
            <button class="btn btn-primary" onclick="showToast('âœ…','Blocks Scheduled!','Tuesday and Thursday 9â€“11 AM blocked for YouTube content creation')">Accept AI Blocks</button>
            <button class="btn btn-ghost" onclick="showToast('ğŸ¤–','Nova','I\'ll remind you again on Friday about the YouTube blocks')">Remind Later</button>
          </div>
        </div>
      </div>

    </div><!-- /pages -->
  </div><!-- /main -->
</div><!-- /app -->

<!-- Nova FAB -->
<div class="nova-fab">
  <button class="nova-fab-btn" onclick="switchPage('nova', document.querySelector('.nav-item:nth-child(5)'))">ğŸ¤–</button>
  <div class="nova-fab-label">Ask Nova</div>
</div>

<!-- Pomodoro Timer -->
<div class="pomo-overlay" id="pomo-overlay">
  <div class="pomo-modal">
    <div class="pomo-title">ğŸ… POMODORO TIMER</div>
    <div class="pomo-task" id="pomo-task-name">Finalize pricing page copy</div>
    <div class="pomo-time" id="pomo-time">25:00</div>
    <div class="pomo-controls">
      <button class="btn btn-primary" id="pomo-start-btn" onclick="togglePomodoro()">â–¶ Start</button>
      <button class="btn btn-ghost" onclick="resetPomodoro()">â†º Reset</button>
      <button class="btn btn-ghost" onclick="document.getElementById('pomo-overlay').classList.remove('open')">âœ• Close</button>
    </div>
    <div style="font-size:12px;color:var(--text3);margin-top:16px">Focus session Â· +50 XP on completion</div>
  </div>
</div>

<!-- Achievement Overlay -->
<div class="achievement-overlay" id="achievement-overlay">
  <div class="achievement-card">
    <div class="ach-emoji" id="ach-emoji">ğŸ†</div>
    <div class="ach-label">Achievement Unlocked!</div>
    <div class="ach-name" id="ach-name">Priority Champion</div>
    <div class="ach-desc" id="ach-desc">Completed your #1 priority task!</div>
    <button class="btn btn-ghost" style="margin-top:14px;width:100%" onclick="hideAchievement()">Claim Reward +50 XP</button>
  </div>
</div>

<!-- Toast Container -->
<div id="toast-container"></div>

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DATA MODEL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const GOALS = [
  { id:1, name:'Launch SaaS Product', cat:'ğŸš€ Business', p:'P1', deadline:'Mar 31', daysLeft:42, pct:64, status:'track', milestones:7, milestoneDone:4, streak:9, color:'#3b82f6', weekly:'8h', insight:'You need 4 more milestones in 42 days. At current pace, you\'ll finish exactly on deadline. One missed week could push you over.', rec:'Block 3 hours this Thursday for product testing â€” it\'s your most critical milestone.' },
  { id:2, name:'10K YouTube Subscribers', cat:'ğŸ¬ Content', p:'P1', deadline:'Jun 30', daysLeft:133, pct:38, status:'risk', milestones:6, milestoneDone:2, streak:2, color:'#ef4444', weekly:'3h', insight:'At current pace (avg 1 upload/week), you\'ll reach 10K in 168 days â€” 35 days after your deadline.', rec:'You need 2 uploads/week minimum. Tuesday and Thursday mornings are your best creative windows.' },
  { id:3, name:'Run a Half Marathon', cat:'ğŸ’ª Health', p:'P2', deadline:'Apr 15', daysLeft:57, pct:72, status:'track', milestones:8, milestoneDone:6, streak:14, color:'#10b981', weekly:'6h', insight:'Your training is on track. You\'ve logged 87% of planned mileage this month â€” excellent consistency.', rec:'This week\'s long run (10 miles) is scheduled for Tuesday 6 AM. Don\'t skip it â€” it\'s your peak training phase.' },
  { id:4, name:'Complete AWS Certification', cat:'ğŸ“š Learning', p:'P2', deadline:'May 1', daysLeft:73, pct:25, status:'behind', milestones:10, milestoneDone:2, streak:1, color:'#f59e0b', weekly:'2h', insight:'You are significantly behind pace. You need to complete 8 modules in 73 days. Current rate: 1 module per 2 weeks.', rec:'Increase to 3 modules/week. Morning study sessions (6â€“7 AM) have shown your best retention scores.' },
  { id:5, name:'Publish 12 Blog Posts', cat:'âœï¸ Writing', p:'P3', deadline:'Dec 31', daysLeft:317, pct:42, status:'track', milestones:12, milestoneDone:5, streak:6, color:'#8b5cf6', weekly:'3h', insight:'You\'re ahead of pace â€” 5 posts published with 317 days remaining. At current rate, you\'ll finish in ~8 months.', rec:'Keep your current Friday writing sessions. Consider batching 2 posts per month to build a buffer.' },
];

const TASKS = [
  { id:1, name:'Finalize pricing page copy', goal:'SaaS Launch', goalColor:'#3b82f6', dur:'90 min', score:97, tier:'critical', done:false, reason:'Blocks developer handoff due tomorrow â€” direct impact on launch timeline' },
  { id:2, name:'Record YouTube video â€“ AI Tools ep.', goal:'YouTube Goal', goalColor:'#ef4444', dur:'60 min', score:91, tier:'high', done:false, reason:'4 days since last upload â€” pace is slipping toward At Risk threshold' },
  { id:3, name:'10-mile training run', goal:'Half Marathon', goalColor:'#10b981', dur:'90 min', score:88, tier:'high', done:true, reason:'Peak training window â€” race in 56 days, this week is critical' },
  { id:4, name:'AWS Module 7 â€” Security', goal:'AWS Cert', goalColor:'#f59e0b', dur:'45 min', score:82, tier:'high', done:false, reason:'Goal is 25% behind pace â€” needs daily attention to recover' },
  { id:5, name:'Reply to 3 partnership emails', goal:'SaaS Launch', goalColor:'#3b82f6', dur:'20 min', score:71, tier:'medium', done:false, reason:'Quick wins that unlock collaboration opportunities for launch' },
  { id:6, name:'Draft Q2 marketing brief', goal:'SaaS Launch', goalColor:'#3b82f6', dur:'60 min', score:68, tier:'medium', done:false, reason:'Strategic document needed before team sync on Friday' },
  { id:7, name:'Write blog post outline â€“ Topic 6', goal:'Blog Posts', goalColor:'#8b5cf6', dur:'30 min', score:55, tier:'medium', done:false, reason:'Consistent content creation â€” on track but don\'t let it slip' },
  { id:8, name:'Weekly review & planning session', goal:'All Goals', goalColor:'#6b7280', dur:'30 min', score:48, tier:'low', done:false, reason:'Regular review keeps all goals aligned and priorities fresh' },
];

const CAL_TODAY = [
  { time:'6:00 AM', event:'Morning Run â€” 10 miles', meta:'Half Marathon Â· Recurring', type:'health' },
  { time:'9:00 AM', event:'Deep Work: SaaS Pricing Page', meta:'AI-scheduled Â· 2h block', type:'ai' },
  { time:'11:00 AM', event:'Product Demo Call', meta:'Google Meet Â· 60 min', type:'meet' },
  { time:'2:00 PM', event:'YouTube Script Writing', meta:'AI-scheduled Â· Goal sprint', type:'ai' },
  { time:'4:00 PM', event:'AWS Study Session', meta:'Module 7 Â· 45 min', type:'goal' },
  { time:'7:00 PM', event:'Weekly Review', meta:'Recurring every Tue', type:'work' },
];

const NOVA_RESPONSES = {
  'prioritize my day': `Here's your optimized schedule for today, Jordan:\n\n**Your #1 priority** right now is "Finalize pricing page copy" (Score: 97/100). You have a 90-minute deep focus window opening in 15 minutes and this task blocks your developer who needs it by tomorrow.\n\n**Full day plan:**\nğŸ”´ 9:00 AM â€” Pricing page copy (90 min, CRITICAL)\nğŸŸ¡ 11:00 AM â€” Product Demo call\nğŸ”´ 2:00 PM â€” Record YouTube video (60 min)\nğŸŸ¡ 4:00 PM â€” AWS Module 7 (45 min)\nâšª 5:00 PM â€” Reply to emails (20 min batch)\n\nShould I lock these into your calendar?`,
  "what's my biggest risk this week?": `Your biggest risk this week is your **YouTube goal** ğŸ¬\n\nHere's why it's flagged:\nâ€¢ 4 days since your last upload (your target is every 2 days)\nâ€¢ You're at 38% progress with 133 days to deadline\nâ€¢ At current pace: projected completion **35 days late**\n\nThe fix is straightforward: you need 2 uploads this week to reset the trajectory. Your best window is **today 2â€“4 PM** â€” want me to block it for recording?`,
  "i have 90 minutes free right now": `Perfect timing! ğŸ¯ Here's my recommendation for your 90-minute window:\n\n**Option A â€” High Impact:** "Finalize pricing page copy"\nâ†’ Score: 97/100 Â· Blocks developer handoff\nâ†’ This is your most critical task and 90 min is exactly right\n\n**Option B â€” Clear the Queue:** Knock out 4 quick tasks\nâ†’ 3 partnership emails (20 min)\nâ†’ Blog post outline (30 min)\nâ†’ AWS Module 6 review (40 min)\n\nI recommend **Option A**. The pricing page has been deferred for 3 days and the dependency chain makes it your highest-value use of 90 minutes right now.\n\nShall I start a Pomodoro timer?`,
  "am i going to hit my saas launch goal?": `Honest assessment for your SaaS launch (March 31) ğŸ“Š\n\n**Current status: ON TRACK** âœ… but with margin risk\n\nâ€¢ Progress: 64% complete with 42 days remaining\nâ€¢ Required pace: ~0.85% per day\nâ€¢ Current pace: ~0.76% per day â†’ **9% below target**\n\nIf your pace doesn't improve, you'll hit ~92% by March 31 â€” not quite done.\n\n**What you need to do:**\n1. Complete the pricing page this week (blocks 2 other milestones)\n2. Schedule product testing Thursday (critical path)\n3. Protect your Thursday deep work block â€” no meetings\n\nWant me to restructure this week's schedule to close the gap?`,
  "i'm feeling low energy right now": `Got it, Jordan. Let's work with your energy, not against it ğŸ’™\n\nI've moved your 3 high-focus tasks to tomorrow morning when you're typically at peak performance.\n\n**Your low-energy queue (right now):**\n1. Reply to 3 partnership emails â€” 20 min\n2. Review weekly goal progress â€” 10 min\n3. Update AWS study schedule â€” 10 min\n4. Plan tomorrow's top 3 priorities â€” 10 min\n\nTotal: ~50 minutes of light, low-resistance work.\n\nWant me to set a 25-minute wind-down block at 5 PM and reschedule your deep work to 9 AM tomorrow?`,
  'plan my week around my top goal': `Planning your week around your **#1 goal: SaaS Launch** ğŸš€\n\nHere's your optimized weekly structure:\n\n**Monday** â€” Pricing page final copy (3h morning) + email replies\n**Tuesday** â€” Product demo call + YouTube recording 2â€“4 PM\n**Wednesday** â€” Developer sync + UI bug fixes (high priority)\n**Thursday** â€” Protected deep work 8 AMâ€“12 PM (no meetings allowed)\n**Friday** â€” AWS study + weekly review + next week planning\n\n**This plan:**\nâœ“ Protects 14h for SaaS-critical work\nâœ“ Keeps YouTube goal from falling further behind\nâœ“ Maintains half marathon training\nâœ“ Gives you a buffer if tasks run long\n\nShall I schedule these blocks automatically? (You can adjust before confirming)`
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   NAVIGATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const PAGE_TITLES = {
  dashboard: ['Good Morning, Jordan ğŸ‘‹', 'Tuesday, February 17 Â· 5 goals active Â· Focus Level: High'],
  calendar:  ['ğŸ“… Calendar', 'Week of Feb 17 â€“ 23, 2026 Â· AI Optimized'],
  goals:     ['ğŸ¯ Goal Tracking Hub', '5 active goals Â· 2 on track Â· 1 at risk Â· 1 behind'],
  priority:  ['âš¡ AI Priority Engine', 'Ranked by impact Â· urgency Â· energy match Â· dependencies'],
  nova:      ['ğŸ¤– Nova AI Assistant', 'Powered by Claude Â· Ask me anything about your productivity'],
  analytics: ['ğŸ“Š Analytics & Progress', 'Last 30 days Â· Jordan\'s productivity overview'],
};

function switchPage(id, el) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  document.getElementById('page-' + id).classList.add('active');
  if(el) el.classList.add('active');
  const [title, sub] = PAGE_TITLES[id] || ['PriorityOS',''];
  document.getElementById('topbar-title').textContent = title;
  document.getElementById('topbar-sub').textContent = sub;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOAST SYSTEM
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function showToast(icon, title, msg) {
  const c = document.getElementById('toast-container');
  const t = document.createElement('div');
  t.className = 'toast-item';
  t.innerHTML = `<div class="toast-icon">${icon}</div><div class="toast-body"><div class="toast-title">${title}</div><div class="toast-msg">${msg}</div></div>`;
  c.appendChild(t);
  setTimeout(() => { t.style.opacity='0'; t.style.transform='translateX(20px)'; t.style.transition='all 0.3s'; setTimeout(()=>t.remove(),300); }, 3500);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ACHIEVEMENT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function showAchievement(emoji, name, desc) {
  document.getElementById('ach-emoji').textContent = emoji;
  document.getElementById('ach-name').textContent = name;
  document.getElementById('ach-desc').textContent = desc;
  document.getElementById('achievement-overlay').classList.add('show');
  spawnConfetti();
  setTimeout(hideAchievement, 5000);
}
function hideAchievement() {
  document.getElementById('achievement-overlay').classList.remove('show');
}

function spawnConfetti() {
  const colors = ['#3b82f6','#10b981','#f59e0b','#ef4444','#8b5cf6','#ec4899'];
  for(let i=0;i<60;i++) {
    const c = document.createElement('div');
    c.className = 'confetti-piece';
    c.style.cssText = `left:${Math.random()*100}%;background:${colors[Math.floor(Math.random()*colors.length)]};
      animation-duration:${2+Math.random()*1.5}s;animation-delay:${Math.random()*0.5}s;
      width:${6+Math.random()*8}px;height:${6+Math.random()*8}px;border-radius:${Math.random()>0.5?'50%':'2px'}`;
    document.body.appendChild(c);
    setTimeout(()=>c.remove(), 4000);
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RING COMPONENT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function makeRing(pct, color, size=64, stroke=6) {
  const r = (size-stroke*2)/2;
  const circ = 2*Math.PI*r;
  const dash = circ - (pct/100)*circ;
  return `<div class="ring-wrap" style="width:${size}px;height:${size}px">
    <svg class="ring-svg" width="${size}" height="${size}" viewBox="0 0 ${size} ${size}">
      <circle class="ring-track" cx="${size/2}" cy="${size/2}" r="${r}" stroke-width="${stroke}"/>
      <circle class="ring-fill" cx="${size/2}" cy="${size/2}" r="${r}" stroke-width="${stroke}"
              stroke="${color}" stroke-dasharray="${circ}" stroke-dashoffset="${dash}"/>
    </svg>
    <div class="ring-label" style="font-size:${size*0.18}px;color:${color}">${pct}%</div>
  </div>`;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DASHBOARD: TASKS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function buildDashboardTasks() {
  const c = document.getElementById('dashboard-tasks');
  c.innerHTML = TASKS.slice(0,6).map(t => {
    const colors = {critical:'#ef4444',high:'#f59e0b',medium:'#3b82f6',low:'#6b7280'};
    const scoreColor = t.score>=90?'var(--green)':t.score>=75?'var(--amber)':'var(--text3)';
    return `<div class="task-row ${t.done?'completed':''}" style="border-left-color:${colors[t.tier]}" onclick="toggleTask(${t.id},this)">
      <div class="task-check ${t.done?'done':''}" onclick="event.stopPropagation();toggleTask(${t.id},this.parentElement)">${t.done?'âœ“':''}</div>
      <div style="flex:1">
        <div class="task-name ${t.done?'done':''}">${t.name}</div>
        <div style="display:flex;align-items:center;gap:8px;margin-top:4px">
          <span class="tag tag-work" style="background:${t.goalColor}22;color:${t.goalColor}">${t.goal}</span>
          <span style="font-size:11px;color:var(--text3)">${t.dur}</span>
        </div>
      </div>
      <div style="text-align:right;flex-shrink:0">
        <div class="task-score-badge" style="background:${scoreColor}22;color:${scoreColor}">${t.score}/100</div>
        <div class="score-bar" style="width:60px;margin-top:6px">
          <div class="score-seg" style="background:var(--violet);flex:3"></div>
          <div class="score-seg" style="background:var(--red);flex:2.5"></div>
          <div class="score-seg" style="background:var(--amber);flex:2.5"></div>
          <div class="score-seg" style="background:var(--blue);flex:2"></div>
        </div>
      </div>
    </div>`;
  }).join('');
}

let completedCount = 1; // task 3 is already done
function toggleTask(id, el) {
  const task = TASKS.find(t=>t.id===id);
  if(!task || task.done) return;
  task.done = true;
  completedCount++;
  buildDashboardTasks();
  buildPriorityList();
  showToast('âœ…','Task Complete!',`"${task.name}" marked done! +${task.score>85?50:35} XP`);
  if(completedCount === 3) {
    setTimeout(()=>showAchievement('âš¡','Priority Champion','Completed 3 priority tasks today!'),600);
  }
  // Auto-show periodic toasts
  setTimeout(()=>showToast('ğŸ¤–','Nova says','Great work! You\'re on track for a perfect morning. Your #1 priority is next.'),2000);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DASHBOARD: CALENDAR MINI
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function buildCalMini() {
  const c = document.getElementById('dashboard-cal');
  c.innerHTML = CAL_TODAY.map(ev => `
    <div class="cal-slot cs-${ev.type}" onclick="showToast('ğŸ“…','${ev.event}','${ev.meta}')">
      <div class="cal-time">${ev.time}</div>
      <div>
        <div class="cal-event-name">${ev.event}</div>
        <div class="cal-event-meta">${ev.meta}${ev.type==='ai'?` <span class="badge b-ai" style="font-size:9px;padding:1px 6px">AI</span>`:''}</div>
      </div>
    </div>
  `).join('');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DASHBOARD: GOAL SNAPS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function buildGoalSnaps() {
  const c = document.getElementById('dashboard-goals');
  const statusMap = {track:['b-track','On Track âœ…'], risk:['b-risk','At Risk âš ï¸'], behind:['b-behind','Behind âŒ'], done:['b-done','Done ğŸ‰']};
  c.innerHTML = GOALS.map(g => {
    const [bc, bl] = statusMap[g.status];
    return `<div class="goal-snap" onclick="switchPage('goals', document.querySelectorAll('.nav-item')[2])">
      <div class="gs-head">
        <div>
          <div class="gs-name">${g.name}</div>
          <div class="gs-deadline">ğŸ“… ${g.deadline} Â· ${g.daysLeft}d left</div>
        </div>
        <span class="badge ${bc}">${bl}</span>
      </div>
      <div class="gs-ring-wrap">${makeRing(g.pct, g.color, 56, 5)}</div>
      <div class="gs-footer">
        <span class="badge ${g.p==='P1'?'b-p1':g.p==='P2'?'b-p2':'b-p3'}">${g.p}</span>
        <span class="gs-ai" style="font-size:10px">ğŸ”¥ ${g.streak}d streak</span>
      </div>
    </div>`;
  }).join('');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CALENDAR WEEK VIEW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const DAYS = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
const DATES = [15,16,17,18,19,20,21];
const TODAY_IDX = 2;

const CAL_EVENTS = [
  { day:2, startH:6, dur:1.5, name:'Morning Run 10mi', type:'health', goal:'Half Marathon' },
  { day:2, startH:9, dur:2,   name:'Deep Work: Pricing Page', type:'ai', goal:'SaaS Launch' },
  { day:2, startH:11,dur:1,   name:'Product Demo Call', type:'meet', goal:'' },
  { day:2, startH:14,dur:1,   name:'YouTube Script', type:'ai', goal:'YouTube' },
  { day:2, startH:16,dur:0.75,name:'AWS Study', type:'goal', goal:'AWS Cert' },
  { day:1, startH:9, dur:3,   name:'SaaS Pricing Page', type:'ai', goal:'SaaS Launch' },
  { day:1, startH:14,dur:1,   name:'Team Sync', type:'meet', goal:'' },
  { day:3, startH:10,dur:2,   name:'Demo Calls (Ã—2)', type:'meet', goal:'' },
  { day:3, startH:14,dur:1.5, name:'Content Creation', type:'ai', goal:'YouTube' },
  { day:4, startH:8, dur:3,   name:'ğŸ›¡ï¸ Protected Deep Work', type:'ai', goal:'SaaS Launch' },
  { day:4, startH:14,dur:1.5, name:'Financial Model', type:'work', goal:'SaaS Launch' },
  { day:5, startH:9, dur:1,   name:'Weekly Review', type:'work', goal:'All Goals' },
  { day:5, startH:14,dur:1,   name:'Batch Admin', type:'work', goal:'' },
  { day:6, startH:7, dur:1,   name:'Long Run', type:'health', goal:'Half Marathon' },
];

const HOURS = [6,7,8,9,10,11,12,13,14,15,16,17,18,19,20];

function buildWeekGrid() {
  const g = document.getElementById('week-grid');
  // Header row
  let h = `<div class="wg-time-col wg-header"><div class="wg-time-corner"></div></div>`;
  DAYS.forEach((d,i) => {
    h += `<div class="wg-day-head wg-header">
      <div class="wg-day-name">${d}</div>
      <div class="wg-day-num ${i===TODAY_IDX?'today':''}">${DATES[i]}</div>
    </div>`;
  });

  // Time slots
  let body = `<div class="wg-time-col">`;
  HOURS.forEach(hr => {
    const disp = hr===12?'12 PM':hr<12?`${hr} AM`:`${hr-12} PM`;
    body += `<div class="wg-time-label">${disp}</div>`;
  });
  body += '</div>';

  for(let di=0;di<7;di++) {
    body += `<div class="wg-day-col">`;
    HOURS.forEach(hr => { body += `<div class="wg-hour-slot"></div>`; });

    CAL_EVENTS.filter(e=>e.day===di).forEach(ev => {
      const top = (ev.startH - HOURS[0]) * 60;
      const height = ev.dur * 60;
      body += `<div class="cal-event-block ev-${ev.type}" 
               style="top:${top}px;height:${height}px"
               onclick="showToast('ğŸ“…','${ev.name}','${ev.goal||'General'} Â· ${ev.dur>=1?ev.dur+'h':ev.dur*60+'min'}')">
        ${ev.name}
        ${ev.goal?`<div class="ev-time">${ev.goal}</div>`:''}
      </div>`;
    });
    body += '</div>';
  }

  g.innerHTML = h + body;
}

function toggleAIOptimize() {
  const p = document.getElementById('ai-opt-panel');
  p.classList.toggle('open');
  if(p.classList.contains('open')) {
    showToast('âœ¨','AI Analyzing...','Nova is analyzing your schedule efficiency...');
    setTimeout(()=>showToast('âœ…','Analysis Complete','Found 4 optimization opportunities â€” potential +22% efficiency boost!'), 1200);
  }
}

function applyAIOptimize() {
  document.getElementById('ai-opt-panel').classList.remove('open');
  showToast('âœ¨','AI Optimized!','4 schedule improvements applied. Efficiency: 67% â†’ 89%');
  setTimeout(()=>showAchievement('ğŸ—“ï¸','Schedule Optimizer','Used AI optimization to improve your week!'),800);
}

function setVT(btn) {
  document.querySelectorAll('.vt-btn').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  showToast('ğŸ“…','View Changed',`Switched to ${btn.textContent} view`);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   GOALS HUB
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function buildGoalsStats() {
  const c = document.getElementById('goals-stats-row');
  const stats = [
    { val:'5', label:'Active Goals', color:'var(--blue)', icon:'ğŸ¯' },
    { val:'3', label:'On Track', color:'var(--green)', icon:'âœ…' },
    { val:'1', label:'At Risk', color:'var(--amber)', icon:'âš ï¸' },
    { val:'Apr 15', label:'Next Deadline', color:'var(--violet)', icon:'ğŸ“…' },
  ];
  c.innerHTML = stats.map(s => `
    <div class="card" style="text-align:center">
      <div style="font-size:22px;margin-bottom:6px">${s.icon}</div>
      <div style="font-family:'Syne',sans-serif;font-size:22px;font-weight:800;color:${s.color}">${s.val}</div>
      <div style="font-size:11px;color:var(--text3);margin-top:2px">${s.label}</div>
    </div>
  `).join('');
}

function buildGoalsGrid(filter='all') {
  const g = document.getElementById('goals-grid');
  const statusMap = {track:['b-track','On Track âœ…'], risk:['b-risk','At Risk âš ï¸'], behind:['b-behind','Behind âŒ']};
  const barColors = {track:'var(--green)', risk:'var(--amber)', behind:'var(--red)'};

  const filtered = filter==='all' ? GOALS : GOALS.filter(g => {
    const catMap = {business:'Business', content:'Content', health:'Health', learning:'Learning', writing:'Writing'};
    return g.cat.toLowerCase().includes(catMap[filter]?.toLowerCase()||'');
  });

  g.innerHTML = filtered.map(goal => {
    const [bc, bl] = statusMap[goal.status];
    const bc2 = barColors[goal.status];
    return `<div class="goal-card" onclick="openGoal(${goal.id})">
      <div class="gc-header">
        <div>
          <div class="gc-title">${goal.name}</div>
          <div class="gc-cat">${goal.cat}</div>
        </div>
        <div class="gc-badges">
          <span class="badge ${goal.p==='P1'?'b-p1':goal.p==='P2'?'b-p2':'b-p3'}">${goal.p}</span>
          <span class="badge ${bc}">${bl}</span>
        </div>
      </div>
      <div class="gc-progress-row">
        <div class="gc-ring-area">${makeRing(goal.pct, goal.color, 72, 6)}</div>
        <div class="gc-metrics">
          <div class="gc-metric-row">
            <span class="gc-metric-label">Deadline</span>
            <span class="gc-metric-val">ğŸ“… ${goal.deadline} (${goal.daysLeft}d)</span>
          </div>
          <div class="gc-metric-row">
            <span class="gc-metric-label">Milestones</span>
            <span class="gc-metric-val">${goal.milestoneDone}/${goal.milestones}</span>
          </div>
          <div class="gc-bar"><div class="gc-bar-fill" style="width:${(goal.milestoneDone/goal.milestones)*100}%;background:${goal.color}"></div></div>
          <div class="gc-metric-row" style="margin-top:8px">
            <span class="gc-metric-label">Weekly hours</span>
            <span class="gc-metric-val">${goal.weekly}</span>
          </div>
          <div class="gc-metric-row">
            <span class="gc-metric-label">Streak</span>
            <span class="gc-metric-val">ğŸ”¥ ${goal.streak} days</span>
          </div>
        </div>
      </div>
      <div class="gc-ai-insight">
        <div class="gc-ai-label">ğŸ¤– AI Insight</div>
        <div class="gc-ai-text">${goal.insight}</div>
      </div>
      <div style="background:var(--surface2);border:1px solid var(--border);border-radius:var(--r2);padding:10px 12px;margin-bottom:12px">
        <div style="font-size:10px;color:var(--green);font-weight:700;margin-bottom:3px">ğŸ’¡ RECOMMENDATION</div>
        <div style="font-size:12px;color:var(--text2)">${goal.rec}</div>
      </div>
      <div class="gc-footer">
        <button class="btn btn-primary btn-sm" onclick="event.stopPropagation();showToast('ğŸ“…','Scheduled!','Task added to tomorrow 9 AM')">Schedule Now</button>
        <button class="btn btn-ghost btn-sm" onclick="event.stopPropagation();showToast('ğŸ“‹','Milestone Added!','New checkpoint added to ${goal.name}')">+ Milestone</button>
        <button class="btn btn-ghost btn-sm" onclick="event.stopPropagation();showToast('âœï¸','Edit Mode','Opening goal editor...')">Edit</button>
      </div>
    </div>`;
  }).join('');
}

function openGoal(id) {
  const g = GOALS.find(g=>g.id===id);
  showToast('ğŸ¯', g.name, `${g.pct}% complete Â· ${g.daysLeft} days remaining Â· ${g.status==='track'?'On Track âœ…':g.status==='risk'?'At Risk âš ï¸':'Behind âŒ'}`);
}

function filterGoals(filter, btn) {
  document.querySelectorAll('.gf-pill').forEach(p=>p.classList.remove('active'));
  btn.classList.add('active');
  buildGoalsGrid(filter);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PRIORITY ENGINE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function buildPriorityList() {
  // Spotlight top 3
  const sg = document.getElementById('spotlight-grid');
  const spotStyles = ['spot-1','spot-2','spot-3'];
  const medals = ['ğŸ¥‡','ğŸ¥ˆ','ğŸ¥‰'];
  sg.innerHTML = TASKS.filter(t=>!t.done).slice(0,3).map((t,i) => `
    <div class="spotlight-card ${spotStyles[i]}" onclick="openPomodoro('${t.name.substring(0,30)}')">
      <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:8px">
        <div class="spot-rank">#${i+1}</div>
        <div>${medals[i]}</div>
      </div>
      <div class="spot-name">${t.name}</div>
      <span class="tag tag-work" style="background:${t.goalColor}22;color:${t.goalColor};margin-bottom:8px;display:inline-block">${t.goal}</span>
      <div style="display:flex;align-items:baseline;gap:4px;margin-bottom:4px">
        <div class="spot-score" style="color:${t.score>=90?'var(--green)':t.score>=80?'var(--amber)':'var(--blue)'}">${t.score}</div>
        <div class="spot-score-label">/100</div>
      </div>
      <div class="spot-reason">${t.reason}</div>
      <div style="display:flex;gap:4px;margin-bottom:10px">
        <span class="badge ${t.tier==='critical'?'b-critical':t.tier==='high'?'b-high':'b-medium'}" style="text-transform:uppercase">${t.tier}</span>
        <span style="font-size:11px;color:var(--text3);padding:3px 0">${t.dur}</span>
      </div>
      <div class="start-timer-btn">ğŸ… Start Timer</div>
    </div>
  `).join('');

  // List 4-10
  const pl = document.getElementById('priority-list');
  const rem = TASKS.filter(t=>!t.done);
  pl.innerHTML = rem.slice(3).map((t,i) => {
    const scoreColor = t.score>=90?'var(--green)':t.score>=75?'var(--amber)':'var(--blue)';
    return `<div class="pri-row">
      <div class="pri-rank">${i+4}</div>
      <div class="pri-content">
        <div class="pri-name">${t.name}</div>
        <div class="pri-reason">ğŸ¤– ${t.reason}</div>
        <div class="pri-tags">
          <span class="tag tag-work" style="background:${t.goalColor}22;color:${t.goalColor}">${t.goal}</span>
          <span class="badge ${t.tier==='critical'?'b-critical':t.tier==='high'?'b-high':t.tier==='medium'?'b-medium':'b-low'}">${t.tier}</span>
          <span style="font-size:11px;color:var(--text3)">${t.dur}</span>
        </div>
      </div>
      <div style="text-align:right;flex-shrink:0;margin-right:12px">
        <div style="font-family:'Syne',sans-serif;font-size:16px;font-weight:800;color:${scoreColor}">${t.score}</div>
        <div style="font-size:10px;color:var(--text3)">/100</div>
      </div>
      <div class="pri-actions">
        <button class="btn btn-primary btn-xs" onclick="startTask(${t.id})">Start</button>
        <button class="btn btn-ghost btn-xs" onclick="showToast('ğŸ“…','Deferred','Task moved to tomorrow')">Defer</button>
        <button class="btn btn-ghost btn-xs" onclick="showToast('ğŸ‘¥','Delegated','Task flagged for delegation')">Delegate</button>
      </div>
    </div>`;
  }).join('');
}

function startTask(id) {
  const t = TASKS.find(t=>t.id===id);
  if(t) { openPomodoro(t.name.substring(0,30)); }
}

function refreshPriorities() {
  showToast('ğŸ”„','Refreshing...','Nova is recalculating priorities based on current context...');
  setTimeout(()=>showToast('âš¡','Updated!','Priority list refreshed â€” 87% AI confidence'), 1500);
}

function setCtx(btn) {
  document.querySelectorAll('.ctx-btn').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  showToast('ğŸ”','Context Filter',`Showing "${btn.textContent.trim()}" tasks`);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   POMODORO TIMER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let pomodoroInterval = null;
let pomodoroSeconds = 25 * 60;
let pomodoroRunning = false;

function openPomodoro(taskName) {
  document.getElementById('pomo-task-name').textContent = taskName;
  document.getElementById('pomo-overlay').classList.add('open');
  pomodoroSeconds = 25 * 60;
  pomodoroRunning = false;
  document.getElementById('pomo-start-btn').textContent = 'â–¶ Start';
  updatePomodoroDisplay();
}

function togglePomodoro() {
  if(pomodoroRunning) {
    clearInterval(pomodoroInterval);
    pomodoroRunning = false;
    document.getElementById('pomo-start-btn').textContent = 'â–¶ Resume';
  } else {
    pomodoroRunning = true;
    document.getElementById('pomo-start-btn').textContent = 'â¸ Pause';
    pomodoroInterval = setInterval(() => {
      if(pomodoroSeconds > 0) {
        pomodoroSeconds--;
        updatePomodoroDisplay();
      } else {
        clearInterval(pomodoroInterval);
        pomodoroRunning = false;
        document.getElementById('pomo-overlay').classList.remove('open');
        showToast('ğŸ…','Pomodoro Complete!','25 minutes of focused work done! +50 XP earned');
        setTimeout(()=>showAchievement('ğŸ”¥','Deep Worker!','Completed a 25-minute focused work session!'), 500);
      }
    }, 1000);
  }
}

function resetPomodoro() {
  clearInterval(pomodoroInterval);
  pomodoroRunning = false;
  pomodoroSeconds = 25 * 60;
  document.getElementById('pomo-start-btn').textContent = 'â–¶ Start';
  updatePomodoroDisplay();
}

function updatePomodoroDisplay() {
  const m = Math.floor(pomodoroSeconds/60).toString().padStart(2,'0');
  const s = (pomodoroSeconds%60).toString().padStart(2,'0');
  document.getElementById('pomo-time').textContent = `${m}:${s}`;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   NOVA AI CHAT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const chatHistory = [];

function initChat() {
  const msgs = document.getElementById('chat-messages');
  msgs.innerHTML = `
    <div class="msg msg-nova">
      <div class="msg-avatar msg-a-nova">ğŸ¤–</div>
      <div>
        <div class="msg-bubble">Hey Jordan! ğŸ‘‹ I'm Nova, your AI productivity assistant. I've analyzed your 5 active goals, today's schedule, and your work patterns.<br><br>
        You have <strong>3 critical tasks</strong> today. Your peak focus window opens in <strong>~12 minutes</strong> â€” perfect timing to start the pricing page copy.<br><br>
        What can I help you with? You can ask me anything about your goals, schedule, or priorities.</div>
        <div class="msg-time">Just now</div>
      </div>
    </div>`;
}

function sendChat() {
  const input = document.getElementById('chat-input');
  const msg = input.value.trim();
  if(!msg) return;
  input.value = '';
  addUserMsg(msg);
  showTyping();
  const lower = msg.toLowerCase();
  let resp = null;
  for(const key of Object.keys(NOVA_RESPONSES)) {
    if(lower.includes(key.toLowerCase()) || key.toLowerCase().includes(lower.split(' ').slice(0,3).join(' '))) {
      resp = NOVA_RESPONSES[key]; break;
    }
  }
  if(!resp) {
    callClaudeAPI(msg);
  } else {
    setTimeout(()=>{ hideTyping(); addNovaMsg(resp); }, 1200 + Math.random()*800);
  }
}

function quickAsk(msg) {
  document.getElementById('chat-input').value = msg;
  sendChat();
}

async function callClaudeAPI(userMsg) {
  const context = `You are Nova, an AI productivity assistant inside PriorityOS. The user is Jordan, a founder/entrepreneur.
Jordan's active goals: 
1. Launch SaaS Product (P1, 64% complete, due Mar 31, On Track)
2. 10K YouTube Subscribers (P1, 38% complete, due Jun 30, At Risk)
3. Run Half Marathon (P2, 72% complete, due Apr 15, On Track)
4. AWS Certification (P2, 25% complete, due May 1, Behind)
5. Publish 12 Blog Posts (P3, 42% complete, due Dec 31, On Track)
Today's top priorities: pricing page copy (97/100), YouTube video (91/100), 10-mile run (done), AWS module (82/100).
Current streak: 14 days. Productivity score: 78/100. Peak focus window: 9-11 AM.
Be warm, direct, specific. Use Jordan's actual data. Keep responses under 150 words. Use bold and line breaks for clarity. Always give a specific actionable recommendation.`;

  try {
    const response = await fetch('https://api.anthropic.com/v1/messages', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        model: 'claude-sonnet-4-5-20250929',
        max_tokens: 300,
        system: context,
        messages: [{ role: 'user', content: userMsg }]
      })
    });
    const data = await response.json();
    hideTyping();
    if(data.content && data.content[0]) {
      addNovaMsg(data.content[0].text);
    } else {
      addNovaMsg("I'm having a moment of reflection here. Try asking me about your priorities, goals, or schedule â€” I'm best with specific productivity questions!");
    }
  } catch(e) {
    hideTyping();
    addNovaMsg("I couldn't connect right now, but based on your current data: your **#1 priority** is the pricing page copy (97/100 score). Start there â€” it's been deferred 3 days and blocks your developer. Your peak focus window is in 12 minutes. Want me to set a Pomodoro timer?");
  }
}

function addUserMsg(msg) {
  const c = document.getElementById('chat-messages');
  const now = new Date().toLocaleTimeString('en-US',{hour:'numeric',minute:'2-digit'});
  c.innerHTML += `<div class="msg msg-user">
    <div class="msg-avatar msg-a-user">J</div>
    <div>
      <div class="msg-bubble">${escapeHtml(msg)}</div>
      <div class="msg-time" style="text-align:right">${now}</div>
    </div>
  </div>`;
  c.scrollTop = c.scrollHeight;
}

let typingEl = null;
function showTyping() {
  const c = document.getElementById('chat-messages');
  typingEl = document.createElement('div');
  typingEl.className = 'msg msg-nova';
  typingEl.id = 'typing-msg';
  typingEl.innerHTML = `<div class="msg-avatar msg-a-nova">ğŸ¤–</div>
    <div class="typing-indicator">
      <div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div>
    </div>`;
  c.appendChild(typingEl);
  c.scrollTop = c.scrollHeight;
}

function hideTyping() {
  const t = document.getElementById('typing-msg');
  if(t) t.remove();
}

function addNovaMsg(msg) {
  const c = document.getElementById('chat-messages');
  const now = new Date().toLocaleTimeString('en-US',{hour:'numeric',minute:'2-digit'});
  const formatted = msg.replace(/\*\*(.*?)\*\*/g,'<strong>$1</strong>').replace(/\n/g,'<br>');
  c.innerHTML += `<div class="msg msg-nova">
    <div class="msg-avatar msg-a-nova">ğŸ¤–</div>
    <div>
      <div class="msg-bubble">${formatted}</div>
      <div class="msg-time">${now}</div>
    </div>
  </div>`;
  c.scrollTop = c.scrollHeight;
}

function clearChat() {
  initChat();
  showToast('ğŸ¤–','Chat Cleared','Started a fresh conversation with Nova');
}

function escapeHtml(s) {
  return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ANALYTICS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function buildHeatmap() {
  const g = document.getElementById('heatmap-grid');
  const levels = [0,0,1,1,2,2,3,4,3,2,1,2,3,4,4,3,2,3,4,3,2,1,0,0,1,2,3,4,4,3,
                  2,1,2,3,4,4,3,2,1,0,1,2,3,4,3,2,1,2,3,4,4,3,2,1,2,3,4,3,2,1,
                  0,1,2,3,4,3,2,1,0,1,2,3,4,4,3,2,3,4,4,3,2,3,4,4,3,2,1,2,3,4];
  g.innerHTML = levels.slice(0,91).map(l =>
    `<div class="hm-cell hm-${l}" onclick="showToast('ğŸ“…','Focus Day','High focus day! Great work ğŸ’ª')"></div>`
  ).join('');
}

function buildDonut() {
  const data = [
    {label:'SaaS Launch', pct:42, color:'#3b82f6'},
    {label:'YouTube', pct:18, color:'#ef4444'},
    {label:'Training', pct:20, color:'#10b981'},
    {label:'Admin', pct:12, color:'#f59e0b'},
    {label:'Other', pct:8, color:'#6b7280'},
  ];
  const r = 45, cx = 60, cy = 60;
  const circ = 2 * Math.PI * r;
  let offset = 0;
  const svg = document.getElementById('donut-svg');
  const segs = data.map(d => {
    const dash = (d.pct/100)*circ;
    const seg = `<circle cx="${cx}" cy="${cy}" r="${r}" fill="none"
      stroke="${d.color}" stroke-width="18"
      stroke-dasharray="${dash} ${circ-dash}"
      stroke-dashoffset="${-offset}"
      transform="rotate(-90 ${cx} ${cy})"/>`;
    offset += dash;
    return seg;
  });
  svg.innerHTML = '<circle cx="60" cy="60" r="45" fill="none" stroke="rgba(255,255,255,0.05)" stroke-width="18"/>' + segs.join('');

  document.getElementById('donut-legend').innerHTML = data.map(d =>
    `<div class="dl-item"><div class="dl-dot" style="background:${d.color}"></div><span>${d.label}</span><strong style="margin-left:auto;padding-left:8px">${d.pct}%</strong></div>`
  ).join('');
}

function buildBarChart() {
  const c = document.getElementById('bar-chart');
  const data = [
    {label:'Mon', val:85, color:'var(--blue)'},
    {label:'Tue', val:92, color:'var(--green)'},
    {label:'Wed', val:61, color:'var(--amber)'},
    {label:'Thu', val:78, color:'var(--blue)'},
    {label:'Fri', val:45, color:'var(--red)'},
    {label:'Sat', val:70, color:'var(--violet)'},
    {label:'Sun', val:55, color:'var(--blue)'},
  ];
  c.innerHTML = data.map(d => `
    <div class="bc-bar-wrap">
      <div class="bc-val">${d.val}%</div>
      <div class="bc-bar" style="height:${d.val}%;background:${d.color};max-height:100px"></div>
      <div class="bc-label">${d.label}</div>
    </div>
  `).join('');
}

function buildGoalHealthBars() {
  const c = document.getElementById('goal-health-bars');
  c.innerHTML = GOALS.map(g => {
    const color = g.status==='track'?'var(--green)':g.status==='risk'?'var(--amber)':'var(--red)';
    return `<div style="margin-bottom:12px">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:5px">
        <span style="font-size:12px;font-weight:600">${g.name}</span>
        <span style="font-size:12px;font-weight:700;color:${color}">${g.pct}%</span>
      </div>
      <div style="background:rgba(255,255,255,0.06);height:7px;border-radius:4px;overflow:hidden">
        <div style="width:${g.pct}%;height:100%;background:${color};border-radius:4px;transition:width 1s ease"></div>
      </div>
    </div>`;
  }).join('');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   GREETING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function setGreeting() {
  const h = new Date().getHours();
  const g = h<12 ? 'Good morning' : h<18 ? 'Good afternoon' : 'Good evening';
  const icon = h<12 ? 'ğŸŒ…' : h<18 ? 'â˜€ï¸' : 'ğŸŒ™';
  document.getElementById('brief-greeting').textContent = `${g}, Jordan! ${icon} You're on pace for a strong week.`;
  document.getElementById('topbar-title').textContent = `${g}, Jordan ğŸ‘‹`;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PERIODIC TOASTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const periodicToasts = [
  ['â°', 'Peak Focus Window', 'Your highest-focus window opens now (9â€“11 AM). Start "Pricing Page Copy" for maximum output.'],
  ['âš ï¸', 'Goal Alert', 'YouTube goal is 4 days behind upload schedule. Nova recommends recording today at 2 PM.'],
  ['ğŸ¯', 'Priority Updated', 'Nova refreshed priorities â€” "AWS Module 7" moved up after detecting 3-day delay.'],
  ['ğŸ’¡', 'AI Insight', 'You\'re 3Ã— more likely to complete tasks before 10 AM. Two big tasks scheduled for morning.'],
  ['ğŸ”¥', 'Streak Alert', '14-day streak! One more productive day keeps your momentum. Your next badge is at 30 days.'],
];
let toastIdx = 0;
setInterval(() => {
  if(document.visibilityState === 'visible') {
    const [icon, title, msg] = periodicToasts[toastIdx % periodicToasts.length];
    showToast(icon, title, msg);
    toastIdx++;
  }
}, 18000);

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   INIT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
document.addEventListener('DOMContentLoaded', () => {
  setGreeting();
  buildDashboardTasks();
  buildCalMini();
  buildGoalSnaps();
  buildWeekGrid();
  buildGoalsStats();
  buildGoalsGrid();
  buildPriorityList();
  initChat();
  buildHeatmap();
  buildDonut();
  buildBarChart();
  buildGoalHealthBars();

  // Welcome toast after short delay
  setTimeout(()=>showToast('âš¡','PriorityOS','Welcome back, Jordan! Nova has 3 priority updates for you today.'), 1200);
  setTimeout(()=>showToast('ğŸ¤–','Nova says','Your peak focus window opens in 12 minutes. Pricing page is ready to go!'), 3500);
});
</script>
</body>
</html>
